<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lmm.cool","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="SpringBootå…¥é—¨æŒ‡å— ä»¥springä¸ºåŸºç¡€çš„åº”ç”¨æ­å»ºä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBootå…¥é—¨æŒ‡å—">
<meta property="og:url" content="http://lmm.cool/2020/04/12/SpringBoot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="æŠ«ç€ä»£ç çš„ğŸ">
<meta property="og:description" content="SpringBootå…¥é—¨æŒ‡å— ä»¥springä¸ºåŸºç¡€çš„åº”ç”¨æ­å»ºä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-04-12T04:07:40.000Z">
<meta property="article:modified_time" content="2020-04-17T12:36:54.968Z">
<meta property="article:author" content="yong">
<meta property="article:tag" content="spring">
<meta property="article:tag" content="springboot">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://lmm.cool/2020/04/12/SpringBoot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SpringBootå…¥é—¨æŒ‡å— | æŠ«ç€ä»£ç çš„ğŸ</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">æŠ«ç€ä»£ç çš„ğŸ</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to æˆ‘çš„å°ç«™</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Herface" class="github-corner" title="Fork me on GitHub" aria-label="Fork me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lmm.cool/2020/04/12/SpringBoot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="yong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ«ç€ä»£ç çš„ğŸ">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SpringBootå…¥é—¨æŒ‡å—
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-12 12:07:40" itemprop="dateCreated datePublished" datetime="2020-04-12T12:07:40+08:00">2020-04-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="SpringBootå…¥é—¨æŒ‡å—"><a href="#SpringBootå…¥é—¨æŒ‡å—" class="headerlink" title="SpringBootå…¥é—¨æŒ‡å—"></a>SpringBootå…¥é—¨æŒ‡å—</h1><blockquote>
<p>ä»¥springä¸ºåŸºç¡€çš„åº”ç”¨æ­å»ºä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ</p>
</blockquote>
<a id="more"></a>
<p>è§£å†³äº†ä¼ ç»Ÿspringåº”ç”¨é…ç½®ç¹æ‚çš„ç—›ç‚¹ åªéœ€è¦å°‘é‡æˆ–æ— éœ€é…ç½® (å†…åµŒwebå®¹å™¨) å°±èƒ½æ„å»ºä¸€ä¸ªäº§å“çº§åº”ç”¨ æå¤§ç®€åŒ–å¼€å‘</p>
<blockquote>
<p>åº•å±‚ä½¿ç”¨äº†å¤§é‡çš„è‡ªåŠ¨é…ç½®</p>
<p>ä¸å¾®æœåŠ¡æ¶æ„<strong>(å°†ä¸€ä¸ªå¤§å‹åº”ç”¨æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°æœåŠ¡ æ¯ä¸ªæœåŠ¡é€šè¿‡httpåè®®è¿›è¡Œé€šä¿¡)</strong>é€šè¿‡<strong>spring cloud</strong>è¿æ¥  é€šè¿‡springboot å¯ä»¥å¿«é€Ÿæ„å»ºä¸€ä¸ªå¾®æœåŠ¡å•å…ƒ</p>
</blockquote>
<h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><h3 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h3><ol>
<li>ä½¿ç”¨springå®˜ç½‘çš„å¯åŠ¨å™¨ç”Ÿæˆä¸€ä¸ªé¡¹ç›® å¹¶å¯¼å…¥IDE</li>
<li>ä½¿ç”¨IDEAçš„spring initializråˆ›å»º é¡¹ç›®åŸºäºmaven</li>
</ol>
<h3 id="ç›®å½•ä¸€è§ˆ"><a href="#ç›®å½•ä¸€è§ˆ" class="headerlink" title="ç›®å½•ä¸€è§ˆ"></a>ç›®å½•ä¸€è§ˆ</h3><blockquote>
<p>springbooté¡¹ç›®ç›®å½•ç»“æ„ </p>
</blockquote>
<ul>
<li><p>mian ä¸»è¦ä»£ç </p>
<ul>
<li>java ä»£ç ç›®å½•</li>
<li>resources èµ„æºç›®å½•<ul>
<li>static é™æ€èµ„æºç›®å½• (web)</li>
<li>templates æ¨¡æ¿ç›®å½• (web)</li>
<li>application.properties é…ç½®æ–‡ä»¶</li>
</ul>
</li>
</ul>
</li>
<li><p>test æµ‹è¯•ä»£ç </p>
</li>
</ul>
<h3 id="å¯åŠ¨ç±»"><a href="#å¯åŠ¨ç±»" class="headerlink" title="å¯åŠ¨ç±»"></a>å¯åŠ¨ç±»</h3><blockquote>
<p>åŒ…å«mainæ–¹æ³• å¯å¯åŠ¨ä¸€ä¸ªspring booté¡¹ç›®</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * spring boot å¯åŠ¨ç±»</span></span><br><span class="line"><span class="comment"> *ç”±æ­¤å¯åŠ¨ä¸€ä¸ªspring bootåº”ç”¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@SpringBootApplication</span> æ­¤æ³¨è§£æ‹…ä»» beané…ç½® å¯ç”¨è‡ªåŠ¨é…ç½® beanæ‰«æ(æ‰«æåŒåŒ…ä¸‹)ç­‰åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootHelloworldApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringBootHelloworldApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é¡¹ç›®æ‰“åŒ…"><a href="#é¡¹ç›®æ‰“åŒ…" class="headerlink" title="é¡¹ç›®æ‰“åŒ…"></a>é¡¹ç›®æ‰“åŒ…</h3><blockquote>
<p>å¯é€šè¿‡æ’ä»¶å°†spring booté¡¹ç›®æ‰“åŒ…æˆjaråŒ…</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    æ­¤æ’ä»¶å¯å°†é¡¹ç›®æ‰“æˆjaråŒ…</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="é¡¹ç›®ä¾èµ–"><a href="#é¡¹ç›®ä¾èµ–" class="headerlink" title="é¡¹ç›®ä¾èµ–"></a>é¡¹ç›®ä¾èµ–</h3><blockquote>
<p>springbootä¾èµ–ä¸å„ä¸ªæ¡†æ¶çš„ä¾èµ–å…³ç³»åŠç‰ˆæœ¬</p>
</blockquote>
<ul>
<li><p>ç‰ˆæœ¬ä»²è£</p>
<p>springbootåªç”¨ä¸€ä¸ªçˆ¶é¡¹ç›®æ¥ç®¡ç†å„ä¾èµ–ç‰ˆæœ¬</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœºæ™¯å¯åŠ¨å™¨</p>
<p>æ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯ å°†ç›¸å…³ä¾èµ–æŠ½å–ä¸ºä¸€ä¸ªä¸ªstarter è¦ä½¿ç”¨è¯¥åœºæ™¯æ—¶åªéœ€å¯¼å…¥ç›¸å…³çš„starter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="å¯åŠ¨æµç¨‹"><a href="#å¯åŠ¨æµç¨‹" class="headerlink" title="å¯åŠ¨æµç¨‹"></a>å¯åŠ¨æµç¨‹</h3><blockquote>
<p>springbootå¯åŠ¨æµç¨‹</p>
</blockquote>
<ul>
<li><p>mainæ–¹æ³•å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(SpringbootJpaApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»º<strong>SpringbootApplication</strong>å®ä¾‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings</span>(&#123; <span class="string">"unchecked"</span>, <span class="string">"rawtypes"</span> &#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.resourceLoader = resourceLoader;</span><br><span class="line">    Assert.notNull(primarySources, <span class="string">"PrimarySources must not be null"</span>);</span><br><span class="line">    <span class="comment">// å°†ä¸»é…ç½®ç±»æ·»åŠ è‡³é›†åˆ</span></span><br><span class="line">    <span class="keyword">this</span>.primarySources = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºwebåº”ç”¨</span></span><br><span class="line">    <span class="keyword">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°ç±»è·¯å¾„ä¸‹META-INF/spring.factoriesä¸‹æ‰€æœ‰çš„ApplicationContextInitializer</span></span><br><span class="line">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">    <span class="comment">// ä»META-INF/spring.factoriesæ‰¾åˆ°æ‰€æœ‰çš„ApplicationListener</span></span><br><span class="line">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°å¸¦mainæ–¹æ³•çš„é…ç½®ç±»</span></span><br><span class="line">    <span class="keyword">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>runæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(String... args)</span> </span>&#123;</span><br><span class="line">		StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">		stopWatch.start();</span><br><span class="line">		ConfigurableApplicationContext context = <span class="keyword">null</span>;</span><br><span class="line">		Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		configureHeadlessProperty();</span><br><span class="line">    	<span class="comment">//ä»META-INF/spring.factories è·å– SpringApplicationRunListeners</span></span><br><span class="line">		SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class="line">    	<span class="comment">// å›è°ƒæ¯ä¸ªSpringApplicationRunListenerçš„startingæ–¹æ³•</span></span><br><span class="line">		listeners.starting();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å°è£…å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">			ApplicationArguments applicationArguments = <span class="keyword">new</span> DefaultApplicationArguments(args);</span><br><span class="line">			<span class="comment">// å‡†å¤‡ç¯å¢ƒ ä»ä¸­å›è°ƒæ¯ä¸ªSpringApplicationRunListenerçš„environmentPreparedæ–¹æ³•</span></span><br><span class="line">            ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class="line">			configureIgnoreBeanInfo(environment);</span><br><span class="line">            <span class="comment">// æ‰“å°springbootæ¨ªå¹…</span></span><br><span class="line">			Banner printedBanner = printBanner(environment);</span><br><span class="line">            <span class="comment">// æ ¹æ®ç¯å¢ƒåˆ›å»ºiocå®¹å™¨</span></span><br><span class="line">			context = createApplicationContext();</span><br><span class="line">            <span class="comment">// é”™è¯¯æŠ¥å‘Š</span></span><br><span class="line">			exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line">					new Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class="line">			<span class="comment">//å‡†å¤‡ä¸Šä¸‹æ–‡ç¯å¢ƒ å…¶ä¸­çš„applyInitializersè°ƒç”¨æ‰€æœ‰ApplicationContextInitializerçš„initializeæ–¹æ³• æœ€åä¼šè°ƒç”¨æ‰€æœ‰çš„contextLoadedæ–¹æ³•</span></span><br><span class="line">            prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class="line">			<span class="comment">// åˆ·æ–°å®¹å™¨ å¦‚æœä¸ºwebåº”ç”¨ è¿˜ä¼šå¯åŠ¨webå®¹å™¨ </span></span><br><span class="line">            refreshContext(context);</span><br><span class="line">            <span class="comment">// ä»iocå®¹å™¨ä¸­è·å–ApplicationRunnerå’Œ CommandLineRunnerå¹¶å›è°ƒ</span></span><br><span class="line">			afterRefresh(context, applicationArguments);</span><br><span class="line">			stopWatch.stop();</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) &#123;</span><br><span class="line">				<span class="keyword">new</span> StartupInfoLogger(<span class="keyword">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// å›è°ƒæ‰€æœ‰listenerçš„startedæ–¹æ³•</span></span><br><span class="line">			listeners.started(context);</span><br><span class="line">			f(context, applicationArguments);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">			handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å›è°ƒæ‰€æœ‰runningæ–¹æ³•</span></span><br><span class="line">			listeners.running(context);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">			handleRunFailure(context, ex, exceptionReporters, <span class="keyword">null</span>);</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> context;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h4><blockquote>
<p>springbooté€šè¿‡äº‹ä»¶ç›‘å¬æœºåˆ¶ åœ¨åº”ç”¨å¯åŠ¨æ—¶å®Œæˆå¯¹é¡¹ç›®çš„é…ç½®</p>
<p>é€šè¿‡ç±»è·¯å¾„ä¸‹META-INFå£°æ˜çš„spring.factoriesæ–‡ä»¶ ä¸­æŒ‡å®šçš„ä¸€ç³»åˆ—ç›‘å¬å™¨ å¯ä»¥åœ¨springbootå¯åŠ¨è¿‡ç¨‹ä¸­è¿›è¡Œå®šåˆ¶åŒ–</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Run Listeners</span></span><br><span class="line"><span class="meta">org.springframework.boot.SpringApplicationRunListener</span>=<span class="string">\</span></span><br><span class="line"><span class="attr">org.springframework.boot.context.event.EventPublishingRunListener</span></span><br><span class="line"><span class="comment"># Application Context Initializers</span></span><br><span class="line"><span class="meta">org.springframework.context.ApplicationContextInitializer</span>=<span class="string">\</span></span><br><span class="line">org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\</span><br><span class="line">org.springframework.boot.context.ContextIdApplicationContextInitializer,\</span><br><span class="line">org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\</span><br><span class="line">org.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\</span><br><span class="line"><span class="attr">org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializer</span></span><br><span class="line"><span class="comment"># éœ€è¦åœ¨IOCä¸­æ³¨å†Œ</span></span><br><span class="line"><span class="comment"># ApplicationRunner CommandLineRunner</span></span><br></pre></td></tr></table></figure>



<h2 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h2><blockquote>
<p>spring bootè‡ªèº«é€šè¿‡å¯¼å…¥å¤§é‡è‡ªåŠ¨é…ç½®ç±»å®Œæˆè‡ªåŠ¨é…ç½®</p>
</blockquote>
<h3 id="è‡ªåŠ¨é…ç½®"><a href="#è‡ªåŠ¨é…ç½®" class="headerlink" title="è‡ªåŠ¨é…ç½®"></a>è‡ªåŠ¨é…ç½®</h3><blockquote>
<p>é€šè¿‡<strong>SpringBootApplication</strong>æ³¨è§£ å¯å¯ç”¨è‡ªåŠ¨é…ç½®è‡ªåŠ¨å¯¼å…¥<strong>org.springframework.boot.autoconfigure</strong> åŒ…ä¸‹çš„è‡ªåŠ¨é…ç½® é€šè¿‡æŸ¥æ‰¾ç±»è·¯å¾„ä¸‹çš„<strong>META-INF/spring.factories</strong> å°†è‡ªåŠ¨é…ç½®ç±»å¯¼å…¥</p>
</blockquote>
<h4 id="å¯ç”¨è‡ªåŠ¨é…ç½®"><a href="#å¯ç”¨è‡ªåŠ¨é…ç½®" class="headerlink" title="å¯ç”¨è‡ªåŠ¨é…ç½®"></a>å¯ç”¨è‡ªåŠ¨é…ç½®</h4><ul>
<li><p>@EnableAutoConfiguration</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import</span>(AutoConfigurationImportSelector<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> @<span class="title">interface</span> <span class="title">EnableAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡AutoConfigurationImportSelectorå¯¼å…¥ç»„ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!isEnabled(annotationMetadata)) &#123;</span><br><span class="line">			<span class="keyword">return</span> NO_IMPORTS;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">// åŠ è½½ç±»è·¯å¾„ä¸‹META-INF/spring-autoconfigure-metadata.propertiesæ‰€å£°æ˜çš„è‡ªåŠ¨é…ç½®ç±»ä¿¡æ¯</span></span><br><span class="line">		AutoConfigurationMetadata autoConfigurationMetadata = AutoConfigurationMetadataLoader</span><br><span class="line">				.loadMetadata(<span class="keyword">this</span>.beanClassLoader); </span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è‡ªåŠ¨é…ç½®</span></span><br><span class="line">		AutoConfigurationEntry autoConfigurationEntry = getAutoConfigurationEntry(autoConfigurationMetadata,</span><br><span class="line">				annotationMetadata);</span><br><span class="line">		<span class="keyword">return</span> StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> AutoConfigurationEntry <span class="title">getAutoConfigurationEntry</span><span class="params">(AutoConfigurationMetadata autoConfigurationMetadata,</span></span></span><br><span class="line"><span class="function"><span class="params">			AnnotationMetadata annotationMetadata)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!isEnabled(annotationMetadata)) &#123;</span><br><span class="line">			<span class="keyword">return</span> EMPTY_ENTRY;</span><br><span class="line">		&#125;</span><br><span class="line">		AnnotationAttributes attributes = getAttributes(annotationMetadata);</span><br><span class="line">    <span class="comment">// è·å–å€™å€™é€‰é…ç½®</span></span><br><span class="line">		List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);</span><br><span class="line">		configurations = removeDuplicates(configurations);</span><br><span class="line">		Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);</span><br><span class="line">		checkExcludedClasses(configurations, exclusions);</span><br><span class="line">		configurations.removeAll(exclusions);</span><br><span class="line">		configurations = filter(configurations, autoConfigurationMetadata);</span><br><span class="line">		fireAutoConfigurationImportEvents(configurations, exclusions);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> AutoConfigurationEntry(configurations, exclusions);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="è‡ªåŠ¨é…ç½®ç±»"><a href="#è‡ªåŠ¨é…ç½®ç±»" class="headerlink" title="è‡ªåŠ¨é…ç½®ç±»"></a>è‡ªåŠ¨é…ç½®ç±»</h4><blockquote>
<p>æ¯ä¸ªxxxAutoConfigurationéƒ½æ˜¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±» åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šåŠ å…¥å®¹å™¨ è¿›è¡Œè‡ªåŠ¨é…ç½®å·¥ä½œ</p>
<p>å¯é€šè¿‡debug=trueå¼€å¯debugæ¨¡å¼ æŸ¥çœ‹å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆ</p>
</blockquote>
<ul>
<li><p>ä»¥<strong>@HttpEncodingAutoConfiguration</strong>ä¸ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="comment">//å¯ç”¨è‡ªåŠ¨é…ç½®å±æ€§ç±» å¹¶å°†è¯¥ç±»åŠ å…¥å®¹å™¨</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(HttpProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">// @<span class="title">ConditionalOnXxx</span> æ ¹æ®ä¸åŒæ¡ä»¶ä½¿é…ç½®ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnWebApplication</span>(<span class="title">type</span> </span>= ConditionalOnWebApplication.Type.SERVLET)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(CharacterEncodingFilter<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnProperty</span>(<span class="title">prefix</span> </span>= <span class="string">"spring.http.encoding"</span>, value = <span class="string">"enabled"</span>, matchIfMissing = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpEncodingAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>é…ç½®å±æ€§ç±» è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å†…å®¹ç”±é…ç½®ç±»å†³å®š XxxProperties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.http"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpProperties</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="comment">// åœ¨å®¹å™¨ç¡®ç¼ºå¤±æ­¤beanæ—¶æ·»åŠ </span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CharacterEncodingFilter <span class="title">characterEncodingFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">CharacterEncodingFilter filter = <span class="keyword">new</span> OrderedCharacterEncodingFilter();</span><br><span class="line"><span class="comment">// beançš„å±æ€§ä»é…ç½®ç±»ä¸­è·å–</span></span><br><span class="line">filter.setEncoding(<span class="keyword">this</span>.properties.getCharset().name());</span><br><span class="line">filter.setForceRequestEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.REQUEST));</span><br><span class="line">filter.setForceResponseEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.RESPONSE));</span><br><span class="line"><span class="keyword">return</span> filter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h4 id="æ¡ä»¶é…ç½®"><a href="#æ¡ä»¶é…ç½®" class="headerlink" title="æ¡ä»¶é…ç½®"></a>æ¡ä»¶é…ç½®</h4><blockquote>
<p>springbootæ‰©å±•äº†å¾ˆå¤šç”±@Conditionalæ´¾ç”Ÿè€Œæ¥çš„æ³¨è§£  è‡ªåŠ¨é…ç½®éœ€è¦é…æ»¡è¶³ä¸€å®šæ¡ä»¶æ‰èƒ½ç”Ÿæ•ˆ</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">åç§°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td align="left">@ConditionalOnBean</td>
<td>å®¹å™¨ä¸­æ˜¯å¦å­˜åœ¨bean</td>
</tr>
<tr>
<td align="left">@ConditionalOnClass</td>
<td>æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„ç±»</td>
</tr>
<tr>
<td align="left">@ConditionalOnCloudPlatform</td>
<td>äº‘å¹³å°æ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€</td>
</tr>
<tr>
<td align="left">@ConditionalOnEnabledResourceChain</td>
<td>æ˜¯å¦å¼€å¯springèµ„æºå¤„ç†é“¾</td>
</tr>
<tr>
<td align="left">@ConditionalOnExpression</td>
<td>ä¾èµ–äºSpringELè¡¨è¾¾å¼çš„å€¼</td>
</tr>
<tr>
<td align="left">@ConditionalOnJava</td>
<td>æ˜¯å¦åŒ¹é…javaç‰ˆæœ¬</td>
</tr>
<tr>
<td align="left">@ConditionalOnJndi</td>
<td>æ˜¯å¦å¼€å¯JNDI</td>
</tr>
<tr>
<td align="left">@ConditionalOnMissingBean</td>
<td>å®¹å™¨ä¸­æ˜¯å¦ç¼ºå¤±bean</td>
</tr>
<tr>
<td align="left">@ConditionalOnMissingClass</td>
<td>ç±»è·¯å¾„ä¸‹æ˜¯å¦ç¼ºå¤±æŒ‡å®šç±»</td>
</tr>
<tr>
<td align="left">@ConditionalOnMissingFilterBean</td>
<td>æ˜¯å¦ç¼ºå¤±æŒ‡å®šç±»å‹çš„è¿‡æ»¤å™¨bean</td>
</tr>
<tr>
<td align="left">@ConditionalOnNotWebApplication</td>
<td>æ˜¯å¦ä¸ä¸ºwebåº”ç”¨</td>
</tr>
<tr>
<td align="left">@ConditionalOnProperty</td>
<td>æ£€æŸ¥æŒ‡å®šå±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼</td>
</tr>
<tr>
<td align="left">@ConditionalOnRepositoryType</td>
<td>æ˜¯å¦å¯ç”¨äº†æŒ‡å®šçš„spring dataæŒä¹…åŒ–ç±»å‹</td>
</tr>
<tr>
<td align="left">@ConditionalOnResource</td>
<td>æ˜¯å¦æŒ‡å®šçš„é…ç½®æ–‡ä»¶åœ¨ç±»è·¯å¾„ä¸‹</td>
</tr>
<tr>
<td align="left">@ConditionalOnSingleCandidate</td>
<td>æ˜¯å¦å­˜åœ¨å•ä¸ªå€™é€‰bean</td>
</tr>
<tr>
<td align="left">@ConditionalOnWebApplication</td>
<td>æ˜¯å¦ä¸ºwebåº”ç”¨</td>
</tr>
</tbody></table>
<h3 id="æ‰‹åŠ¨é…ç½®"><a href="#æ‰‹åŠ¨é…ç½®" class="headerlink" title="æ‰‹åŠ¨é…ç½®"></a>æ‰‹åŠ¨é…ç½®</h3><blockquote>
<p>é€šè¿‡propertiesæˆ–ymlæ–‡ä»¶ä¿®æ”¹é»˜è®¤é…ç½®</p>
</blockquote>
<h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><ul>
<li><p>properties</p>
<blockquote>
<p>ç»å…¸javaé…ç½®æ–‡ä»¶ åŸºäºkey-value</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8081</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>yaml</p>
<blockquote>
<p>ä»¥æ•°æ®é©±åŠ¨ ä»¥å±‚çº§å…³ç³»ä¸ºç»“æ„çš„é…ç½®æ–‡ä»¶ ä»¥ç©ºæ ¼ç¼©è¿›æ¥è¡¨ç¤ºå±‚çº§å…³ç³» å¤§å°å†™æ•æ„Ÿ</p>
<p>å¯ä»¥è¡¨ç¤ºi</p>
</blockquote>
<ul>
<li><p>å­—é¢é‡</p>
<p>â€œâ€ éè½¬ä¹‰å­—ç¬¦ä¸² â€˜â€™ è½¬ä¹‰å­—ç¬¦ä¸²</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span></span><br><span class="line">	<span class="attr">firstName:</span> <span class="string">"das \n"</span></span><br><span class="line">	<span class="attr">lastName:</span> <span class="string">'ada\n'</span></span><br><span class="line">	<span class="attr">isMale:</span> <span class="literal">false</span></span><br><span class="line">	<span class="attr">age:</span> <span class="number">19</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯¹è±¡ map</p>
<p>ç”¨key-valueè¡¨ç¤ºå¯¹è±¡</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user:</span></span><br><span class="line">	<span class="attr">username:</span> <span class="string">"root"</span></span><br><span class="line">	<span class="attr">password:</span> <span class="string">"admin123"</span></span><br></pre></td></tr></table></figure>

<p>è¡Œå†…å†™æ³•</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user:</span> <span class="string">&#123;username:</span> <span class="string">"root"</span><span class="string">,password:</span> <span class="string">admin123&#125;</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>é›†åˆ</p>
<p>ç”¨- è¡¨ç¤ºæ•°ç»„</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">companies:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">apple</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">google</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">amazon</span></span><br></pre></td></tr></table></figure>

<p>è¡Œå†…å†™æ³•</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">companies:</span> <span class="string">[apple,</span> <span class="string">google,</span> <span class="string">amazon]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ··åˆå†™æ³•</p>
<p>å¯¹è±¡+æ•°ç»„</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">users:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">&#123;u:</span> <span class="string">a,</span> <span class="attr">p:</span> <span class="string">a&#125;</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">&#123;u:a,</span> <span class="attr">p:</span> <span class="string">b&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="é…ç½®ç»‘å®š"><a href="#é…ç½®ç»‘å®š" class="headerlink" title="é…ç½®ç»‘å®š"></a>é…ç½®ç»‘å®š</h4><blockquote>
<p>å°†é…ç½®æ–‡ä»¶ç»‘å®šåˆ°bean</p>
</blockquote>
<ol>
<li><p>æ·»åŠ é…ç½®å¤„ç†å™¨ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨è¦ç»‘å®šå±æ€§çš„beanä¸Šæ·»åŠ <strong>@ConfigurationProperties</strong>å¹¶å°†è¯¥beanæ³¨å†Œåˆ°å®¹å™¨ æ”¯æŒæ¾æ•£è¯­æ³• é©¼å³°å‘½åè½¬â€-â€œè¿æ¥ æ”¯æŒJSR303æ•°æ®æ ¡éªŒ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"userinfo"</span>)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; favorites;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡å¯åº”ç”¨ï¼ˆè®©ideæœ‰æç¤ºï¼‰</p>
</li>
<li><p>é…ç½®å±æ€§</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">userinfo:</span></span><br><span class="line">  <span class="attr">id:</span> <span class="number">12</span></span><br><span class="line">  <span class="attr">nickname:</span> <span class="string">javabean</span></span><br><span class="line">  <span class="attr">address:</span></span><br><span class="line">    <span class="attr">province:</span> <span class="string">æ¹–å—</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@Value</strong>é…ç½®</p>
<p>é€šè¿‡æ­¤æ³¨è§£å¯å°†å•ä¸ªé…ç½®æ–‡ä»¶å€¼æ³¨å…¥åˆ°bean å¦‚æœä¸é…ç½®æ–‡ä»¶ä¸­å·²æœ‰å€¼çš„å†²çª åˆ™ä¼˜å…ˆä½¿ç”¨é…ç½®æ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value</span>(<span class="string">"#&#123;6*6&#125;"</span>) <span class="comment">// spring el</span></span><br><span class="line"><span class="keyword">private</span> Integer userId;</span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;description&#125;"</span>) <span class="comment">// ä»é…ç½®æ–‡ä»¶ä¸­è·å–</span></span><br><span class="line"><span class="keyword">private</span> String description;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@PropertiesSource</strong> æŒ‡å®špropertiesé…ç½®æ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource</span>(value = &#123;<span class="string">"classpath:user.properties"</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>å½“ä¸ä¸»é…ç½®æ–‡ä»¶å­˜åœ¨ç›¸åŒé…ç½®æ—¶ ä¼˜å…ˆä½¿ç”¨ä¸»é…ç½®æ–‡ä»¶</p>
</li>
<li><p><strong>@ImportResource</strong> å¯¼å…¥springé…ç½®æ–‡ä»¶</p>
<p>ç”¨åœ¨é…ç½®ç±»ä¸Š å¯å¯¼å…¥åŸºäºxmlçš„beané…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ImportResource</span>(locations = &#123;<span class="string">"classpath:bean.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootHelloworldApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®å ä½ç¬¦</p>
<p>spring bootæä¾›äº†å¤šç§å†…ç½®é…ç½®å ä½ç¬¦</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éšæœºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="attr">description</span>=<span class="string">$&#123;random.value&#125;</span></span><br><span class="line"><span class="comment"># uuid</span></span><br><span class="line"><span class="attr">description</span>=<span class="string">$&#123;random.uuid&#125;</span></span><br><span class="line"><span class="comment"># éšæœºintå€¼</span></span><br><span class="line"><span class="attr">description</span>=<span class="string">$&#123;random.int&#125;</span></span><br><span class="line"><span class="comment"># éšæœºlongå€¼</span></span><br><span class="line"><span class="attr">description</span>=<span class="string">$&#123;random.long&#125;</span></span><br><span class="line"><span class="comment"># è·å–å‰é¢å·²ç»å®šä¹‰çš„å€¼</span></span><br><span class="line"><span class="attr">desc</span>=<span class="string">$&#123;description&#125;</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
<h4 id="æ³¨è§£é…ç½®"><a href="#æ³¨è§£é…ç½®" class="headerlink" title="æ³¨è§£é…ç½®"></a>æ³¨è§£é…ç½®</h4><blockquote>
<p>ä½¿ç”¨æ³¨è§£æ›¿ä»£xml</p>
</blockquote>
<ul>
<li><p><strong>@Configuration</strong></p>
<p>å°†ç±»å®šä¹‰ä¸ºé…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RootConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Bean</span> å°†æ–¹æ³•å®šä¹‰ä¸ºç”Ÿäº§beançš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Address <span class="title">address0</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Address();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§"><a href="#é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§" class="headerlink" title="é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§"></a>é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§</h4><blockquote>
<p>å½“å­˜åœ¨å¤šä¸ªé…ç½®æ–‡ä»¶æ—¶çš„ä¼˜å…ˆçº§</p>
</blockquote>
<ul>
<li><p>åº”ç”¨åœ¨å¯åŠ¨æ—¶ä¼šæŒ‰ç…§å¦‚ä¸‹é¡ºåºåŠ è½½é…ç½®æ–‡ä»¶ (ä¼˜å…ˆçº§ä»é«˜åˆ°ä½) é«˜ä¼˜å…ˆçº§ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§ æœ€ç»ˆä¼šå–å¹¶é›†</p>
<ol>
<li>./config  å·¥ç¨‹ç›®å½•</li>
<li>./ å·¥ç¨‹ç›®å½•</li>
<li>classpath:./config ç±»è·¯å¾„</li>
<li>classpath:./  ç±»è·¯å¾„ </li>
</ol>
</li>
<li><p>é»˜è®¤é…ç½®æ–‡ä»¶</p>
<p>åœ¨é¡¹ç›®æ‰“åŒ…å å¯é€šè¿‡å‘½ä»¤è¡Œå‚æ•° <strong>â€“spring.config.location</strong> æŒ‡å®šé…ç½®æ–‡ä»¶ æ­¤æ—¶è¯¥é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§æœ€é«˜</p>
</li>
<li><p>é…ç½®åŠ è½½é¡ºåº</p>
<p>springbootæ”¯æŒå¤šç§å¤–éƒ¨é…ç½®æ–¹å¼</p>
<p>æŒ‰<strong>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½</strong>ä»¥å¦‚ä¸‹é¡ºåºåŠ è½½é…ç½®</p>
<ol>
<li>å‘½ä»¤è¡Œå‚æ•°</li>
<li>æ¥è‡ªjava:comp.envçš„JNDIå±æ€§</li>
<li>æ¥è‡ªç³»ç»Ÿå±æ€§System.getProperties()</li>
<li>æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡</li>
<li>RadomValuePropertySourceé…ç½®çš„random.*å±æ€§å€¼</li>
<li>jaråŒ…å¤–éƒ¨çš„å¸¦profileé…ç½®çš„application.properties/ymlæ–‡ä»¶</li>
<li>jaråŒ…å†…éƒ¨å¸¦profileé…ç½®çš„application.properties/ymlæ–‡ä»¶</li>
<li>jaråŒ…å¤–éƒ¨ä¸å¸¦profileé…ç½®çš„application.properties/ymlæ–‡ä»¶</li>
<li>jaråŒ…å†…éƒ¨ä¸å¸¦profileé…ç½®çš„application.properties/ymlæ–‡ä»¶</li>
<li>@Configurationæ³¨è§£ç±»ä¸Šçš„@PropertySource</li>
<li>é€šè¿‡SpringApplication.setDefaultPropertiesæŒ‡å®šçš„é»˜è®¤å±æ€§</li>
</ol>
</li>
</ul>
<h3 id="å¤šç¯å¢ƒé…ç½®"><a href="#å¤šç¯å¢ƒé…ç½®" class="headerlink" title="å¤šç¯å¢ƒé…ç½®"></a>å¤šç¯å¢ƒé…ç½®</h3><blockquote>
<p>æ ¹æ®ç¯å¢ƒåˆ‡æ¢é…ç½®</p>
</blockquote>
<h4 id="å¤šProfileé…ç½®æ–‡ä»¶"><a href="#å¤šProfileé…ç½®æ–‡ä»¶" class="headerlink" title="å¤šProfileé…ç½®æ–‡ä»¶"></a>å¤šProfileé…ç½®æ–‡ä»¶</h4><blockquote>
<p>é€šè¿‡å¤šä¸ªappliaction-{profile}æŒ‡å®šå¤šä¸ªç¯å¢ƒçš„é…ç½®æ–‡ä»¶ é»˜è®¤ä¸æŒ‡å®šç¯å¢ƒé…ç½®æ–‡ä»¶ä¸ºapplication </p>
<p>åœ¨propertiesé…ç½®çš„ç¯å¢ƒåœ¨ymlæ–‡ä»¶ä¸­åŒæ ·é€‚ç”¨</p>
</blockquote>
<ul>
<li><p>propertiesæ¿€æ´»ç‰¹å®šç¯å¢ƒ</p>
<p>spring.profiles.activeå±æ€§æŒ‡å®šç¯å¢ƒ appliaction-{profile}é…ç½®å¤šä¸ªç¯å¢ƒé…ç½®æ–‡ä»¶</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">prod</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>yamlåˆ‡æ¢ç¯å¢ƒ</p>
<p>é€šè¿‡æ–‡æ¡£å—åˆ†å‰² å®ç°ä¸€ä¸ªæ–‡ä»¶åˆ‡æ¢å¤šä¸ªç¯å¢ƒ</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span> <span class="comment"># åˆ‡æ¢ä»¥ä¸‹ç¯å¢ƒ</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/prod</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">prod</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/dev</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å‘½ä»¤è¡Œæ–¹å¼åˆ‡æ¢</p>
<p>é€šè¿‡å‘½ä»¤è¡Œå‚æ•° <strong>â€“spring.profiles.active=</strong>åˆ‡æ¢ç¯å¢ƒ</p>
<p>é€šè¿‡è™šæ‹Ÿæœºå‚æ•°<strong>-Dspring.profiles.active=</strong> åˆ‡æ¢ç¯å¢ƒ</p>
</li>
</ul>
<h2 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h2><blockquote>
<p>spring boot é€šè¿‡æ¡¥æ¥å’Œå§”æ‰˜çš„æ–¹å¼å°†æ—¥å¿—æ¡†æ¶ç»Ÿä¸€</p>
<p>springé»˜è®¤åº•å±‚ä½¿ç”¨jclæ—¥å¿—æ¡†æ¶</p>
<p>springboot ä½¿ç”¨äº†slf4jä¸logbackç»„åˆ</p>
<p>åœ¨ä½¿ç”¨ésfl4jå®ç°çš„æ—¥å¿—æ¡†æ¶æ—¶ éœ€è¦å¯¼å…¥é€‚é…å™¨åŒ…</p>
<p><strong>åœ¨springbootä¸­å¼•å…¥å…¶ä»–æ¡†æ¶æ—¶ éœ€è¦æ’é™¤æ—¥å¿—ä¾èµ–</strong></p>
</blockquote>
<h3 id="æ—¥å¿—æ¡†æ¶ç»Ÿä¸€"><a href="#æ—¥å¿—æ¡†æ¶ç»Ÿä¸€" class="headerlink" title="æ—¥å¿—æ¡†æ¶ç»Ÿä¸€"></a>æ—¥å¿—æ¡†æ¶ç»Ÿä¸€</h3><blockquote>
<p>springbooté€šè¿‡starterçš„æ–¹å¼å°†æ—¥å¿—æ¡†æ¶ç»Ÿä¸€ä¸ºslf4j</p>
</blockquote>
<ol>
<li>æ’é™¤å…¶ä»–éslf4jçš„æ—¥å¿—é—¨é¢</li>
<li>å¯¼å…¥ä¸­é—´åŒ…æ›¿æ¢åŸæœ‰æ—¥å¿—æ¡†æ¶</li>
<li>å¯¼å…¥slf4jçš„å®ç°, æˆ–å¯¼å…¥æ¡¥æ¥å™¨åŒ…å°†éslf4jå®ç°è½¬ä¸ºslf4jå®ç°</li>
</ol>
<h3 id="æ—¥å¿—é…ç½®"><a href="#æ—¥å¿—é…ç½®" class="headerlink" title="æ—¥å¿—é…ç½®"></a>æ—¥å¿—é…ç½®</h3><blockquote>
<p>springbooté»˜è®¤æ—¥å¿—çº§åˆ«ä¸ºinfo</p>
<p>å¯é€šè¿‡logging.* é…ç½®æ—¥å¿—</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹æŸä¸ªåŒ…çš„æ—¥å¿—çº§åˆ«</span></span><br><span class="line"><span class="meta">logging.level.com.yong</span>=<span class="string">trace</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶å­˜æ”¾ç›®å½• å¦‚æœä¸ºç›¸å¯¹è·¯å¾„ åˆ™ç›¸å¯¹äºè¯¥é¡¹ç›®</span></span><br><span class="line"><span class="meta">logging.file.name</span>=<span class="string">application.log</span></span><br><span class="line"><span class="comment"># æ—¥å¿—å­˜æ”¾ç›®å½• å¦‚æœä¸ºç›¸å¯¹è·¯å¾„ åˆ™ç›¸å¯¹äºè¯¥é¡¹ç›® å¦‚æœä¸ºç»å¯¹è·¯å¾„ åˆ™ç»å¯¹ä¸è¯¥é¡¹ç›®æ‰€åœ¨çš„ç£ç›˜</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸logging.file.nameåŒæ—¶å­˜åœ¨ åˆ™ä¼šæ­¤é…ç½®ä¸ä¼šç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">logging.file.path</span>=<span class="string">/spring</span></span><br><span class="line"><span class="comment"># æ§åˆ¶å°æ—¥å¿—æ ¼å¼</span></span><br><span class="line"><span class="meta">logging.pattern.console</span>=<span class="string">%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%10t] %-5level %logger&#123;3&#125; - %msg%n</span></span><br><span class="line"><span class="comment"># æ–‡ä»¶æ—¥å¿—æ ¼å¼</span></span><br><span class="line"><span class="meta">logging.pattern.file</span>=<span class="string">%d&#123;yyyy-MM-dd HH:mm:ss&#125;--[%t]--[%5level]--%logger: %msg%n</span></span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h3><blockquote>
<p>å¯é€šè¿‡åœ¨ç±»è·¯å¾„ä¸‹æ”¾ä¸Šå„ä¸ªæ—¥å¿—çš„é…ç½®æ–‡ä»¶ è®©æ—¥å¿—æ¡†æ¶ç›´æ¥è¯»å–</p>
<p>ä¹Ÿå¯ä»¥åœ¨æ–‡ä»¶ååè¿½åŠ xxx.-spring.xx å¯åŠ¨springbootæä¾›çš„é«˜çº§æ—¥å¿—åŠŸèƒ½ æ ¹æ®é…ç½®ç¯å¢ƒé€‰æ‹©é…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">"dev"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125;-[%t]-[%level]-%c: %m%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">"prod"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>[%level]--&gt;%d&#123;yyyy-MM-dd HH:mm:ss&#125;-[%t]--%c: %m%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ‡æ¢æ—¥å¿—æ¡†æ¶"><a href="#åˆ‡æ¢æ—¥å¿—æ¡†æ¶" class="headerlink" title="åˆ‡æ¢æ—¥å¿—æ¡†æ¶"></a>åˆ‡æ¢æ—¥å¿—æ¡†æ¶</h3><blockquote>
<p>springæ”¯æŒé€šè¿‡starterçš„æ–¹å¼åˆ‡æ¢æ—¥å¿—æ¡†æ¶</p>
<p>æ”¯æŒslf4jå’Œlog4j</p>
</blockquote>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><blockquote>
<p>ä½¿ç”¨springbootè¿›è¡Œwebå¼€å‘æ—¶ åªéœ€è¦å¯¼å…¥ç›¸åº”çš„starter å°±èƒ½é€šè¿‡å°‘é‡é…ç½®è¿›è¡Œç›¸å…³åŠŸèƒ½çš„å¼€å‘</p>
</blockquote>
<h3 id="é™æ€èµ„æº"><a href="#é™æ€èµ„æº" class="headerlink" title="é™æ€èµ„æº"></a>é™æ€èµ„æº</h3><blockquote>
<p>springboot webåº”ç”¨å¦‚æœä»¥jaræ‰“åŒ… éœ€è¦é…ç½®é™æ€èµ„æºè·¯å¾„</p>
</blockquote>
<ul>
<li><p>é™æ€èµ„æºæ˜ å°„è§„åˆ™</p>
<ul>
<li><p>webjars</p>
<p>é™æ€èµ„æºé€šè¿‡jaråŒ…çš„æ–¹å¼å¼•å…¥</p>
<p>æŸ¥æ‰¾è·¯å¾„: classpath:META-INF/resources/webjars</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.wbjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå®šä¹‰èµ„æº</p>
<p>é»˜è®¤ä»ä»¥ä¸‹è·¯å¾„æ˜ å°„å’Œ<strong>å½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„</strong>é™æ€èµ„æº</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = &#123; <span class="string">"classpath:/META-INF/resources/"</span>,</span><br><span class="line">			<span class="string">"classpath:/resources/"</span>, <span class="string">"classpath:/static/"</span>, <span class="string">"classpath:/public/"</span> &#125;;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="Thymeleaf"><a href="#Thymeleaf" class="headerlink" title="Thymeleaf"></a>Thymeleaf</h3><blockquote>
<p>springbootæ¨èçš„æ¨¡æ¿å¼•æ“ é€šè¿‡starterçš„æ–¹å¼å¼•å…¥</p>
<p>è¯¦æƒ…<a href="file:///C:/Users/yong/Desktop/NOTE/usingthymeleaf.pdf">thymeleafå®˜æ–¹æ‰‹å†Œ</a></p>
</blockquote>
<ul>
<li><p>è‡ªåŠ¨é…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.thymeleaf"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING = StandardCharsets.UTF_8;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">"classpath:/templates/"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">".html"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰‹åŠ¨é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¦ç”¨æ¨¡æ¿ç¼“å­˜ æ¨¡æ¿å¼•æ“å®æ—¶ç”Ÿæ•ˆ éœ€è¦åœ¨ä¿®æ”¹åæŒ‰ctrl+f9é‡æ–°ç¼–è¯‘(IDEA)</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>å¼•å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åŸºæœ¬è¯­æ³•</p>
<ul>
<li><p>å†…ç½®å¯¹è±¡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ctx : the context object. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">vars: the context variables. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">locale : the context locale. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">request : (only <span class="keyword">in</span> Web Contexts) the HttpServletRequest object. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">response : (only <span class="keyword">in</span> Web Contexts) the HttpServletResponse object. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">session : (only <span class="keyword">in</span> Web Contexts) the HttpSession object. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">servletContext : (only <span class="keyword">in</span> Web Contexts) the ServletContext object.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å·¥å…·å¯¹è±¡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">execInfo : information about the template being processed. </span></span><br><span class="line"><span class="meta">  #</span><span class="bash">messages : methods <span class="keyword">for</span> obtaining externalized messages inside variables expressions, <span class="keyword">in</span> the same way as they would be obtained using <span class="comment">#&#123;â€¦&#125; syntax.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">uris : methods <span class="keyword">for</span> escaping parts of URLs/URIs</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">conversions : methods <span class="keyword">for</span> executing the configured conversion service (<span class="keyword">if</span> any). <span class="comment">#dates : methods for java.util.Date objects: formatting, component extraction, etc. </span></span></span><br><span class="line"><span class="meta">  #</span><span class="bash">calendars : analogous to <span class="comment">#dates , but for java.util.Calendar objects. </span></span></span><br><span class="line"><span class="meta">  #</span><span class="bash">numbers : methods <span class="keyword">for</span> formatting numeric objects. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">strings : methods <span class="keyword">for</span> String objects: contains, startsWith, prepending/appending, etc.</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">objects : methods <span class="keyword">for</span> objects <span class="keyword">in</span> general. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">bools : methods <span class="keyword">for</span> boolean evaluation. </span></span><br><span class="line"><span class="meta">  #</span><span class="bash">arrays : methods <span class="keyword">for</span> arrays. </span></span><br><span class="line"><span class="meta">  #</span><span class="bash">lists : methods <span class="keyword">for</span> lists. </span></span><br><span class="line"><span class="meta">  #</span><span class="bash">sets : methods <span class="keyword">for</span> sets.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">maps : methods <span class="keyword">for</span> maps. </span></span><br><span class="line"><span class="meta">  #</span><span class="bash">aggregates : methods <span class="keyword">for</span> creating aggregates on arrays or collections. </span></span><br><span class="line"><span class="meta">#</span><span class="bash">ids : methods <span class="keyword">for</span> dealing with id attributes that might be repeated (<span class="keyword">for</span> example, as a result of an iteration).</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>æ¶ˆæ¯è¡¨è¾¾å¼</p>
<p>è·å–å›½é™…åŒ–å†…å®¹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"#&#123;home.welcome&#125;"</span>&gt;</span>Welcome to our grocery store!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å˜é‡è¡¨è¾¾å¼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Today is: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;today&#125;"</span>&gt;</span>13 february 2011<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>é€‰æ‹©å™¨è¡¨è¾¾å¼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:object</span>=<span class="string">"$&#123;session.user&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"*&#123;firstName&#125;"</span>&gt;</span>Sebastian<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Surname: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"*&#123;lastName&#125;"</span>&gt;</span>Pepper<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Nationality: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"*&#123;nationality&#125;"</span>&gt;</span>Saturn<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>urlè¡¨è¾¾å¼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"details.html"</span>    <span class="attr">th:href</span>=<span class="string">"@&#123;http://localhost:8080/gtvg/order/details(orderId=$&#123;o.id&#125;)&#125;"</span>&gt;</span>view<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¸¦å‚æ•°çš„url --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;$&#123;url&#125;(orderId=$&#123;o.id&#125;)&#125;"</span>&gt;</span>view<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;'/details/'+$&#123;user.login&#125;(orderId=$&#123;o.id&#125;)&#125;"</span>&gt;</span>view<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>å¾ªç¯</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"prod : $&#123;prods&#125;"</span>&gt;</span>      </span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;prod.name&#125;"</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;prod.price&#125;"</span>&gt;</span>2.41<span class="tag">&lt;/<span class="name">td</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;prod.inStock&#125;? #&#123;true&#125; : #&#123;false&#125;"</span>&gt;</span>yes<span class="tag">&lt;/<span class="name">td</span>&gt;</span>      </span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¼•å…¥ç‰‡æ®µ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:fragment</span>=<span class="string">"copy"</span>&gt;</span>      </span><br><span class="line">    <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- æ’å…¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ›¿æ¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- åŒ…å« åªåŒ…å«å…¶å†…å®¹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:include</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="webmvc"><a href="#webmvc" class="headerlink" title="webmvc"></a>webmvc</h3><blockquote>
<p>springbootè‡ªåŠ¨é…ç½®äº†spring mvc</p>
</blockquote>
<h4 id="è‡ªåŠ¨é…ç½®-1"><a href="#è‡ªåŠ¨é…ç½®-1" class="headerlink" title="è‡ªåŠ¨é…ç½®"></a>è‡ªåŠ¨é…ç½®</h4><blockquote>
<p>spirngbooté»˜è®¤é…ç½®äº†å¦‚ä¸‹å†…å®¹:</p>
</blockquote>
<ul>
<li><p>è§†å›¾è§£æå™¨</p>
</li>
<li><p>é™æ€èµ„æºæ˜ å°„</p>
</li>
<li><p>ç±»å‹è½¬æ¢å™¨ æ—¥å¿—æ ¼å¼åŒ–å™¨</p>
<p>æ—¥æœŸæ ¼å¼åŒ–å™¨é»˜è®¤æ ¼å¼yyyy/MM/dd å¯é€šè¿‡<strong>spring.mvc.date-format</strong>ä¿®æ”¹</p>
</li>
<li><p>æ¶ˆæ¯è½¬æ¢å™¨ ç”¨äºè½¬æ¢httpè¯·æ±‚å’Œå“åº”</p>
</li>
<li><p>é”™è¯¯ä»£ç è§£æå™¨</p>
</li>
<li><p>æ•°æ®ç»‘å®šå™¨</p>
</li>
</ul>
<h4 id="é™„åŠ é…ç½®"><a href="#é™„åŠ é…ç½®" class="headerlink" title="é™„åŠ é…ç½®"></a>é™„åŠ é…ç½®</h4><blockquote>
<p>ç”¨è¿‡è‡ªå®šä¹‰é…ç½®ç±»è¿›è¡Œé™„åŠ é…ç½®</p>
<p>ä¸èƒ½ä½¿ç”¨<strong>@EnableWebMvc</strong> å¦åˆ™springbootçš„spring mvcè‡ªåŠ¨é…ç½®ä¼šå¤±æ•ˆ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰webé…ç½® </span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äº@EnableWebWvc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EnableWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">implements</span> <span class="title">ResourceLoaderAware</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>æŸ¥æ‰¾è‡ªå®šä¹‰é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> WebMvcConfigurerComposite configurers = <span class="keyword">new</span> WebMvcConfigurerComposite();</span><br></pre></td></tr></table></figure>

<p>ä»£ç†é…ç½®ç±»å¯¼å…¥å…¶ä»–è‡ªå®šä¹‰é…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfigurerComposite</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> List&lt;WebMvcConfigurer&gt; delegates = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addWebMvcConfigurers</span><span class="params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!CollectionUtils.isEmpty(configurers)) &#123;</span><br><span class="line">			<span class="keyword">this</span>.delegates.addAll(configurers);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ä½¿ç”¨<strong>@EnableWebMvc</strong>å…¨é¢æ¥ç®¡spring mvcæ—¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import</span>(DelegatingWebMvcConfiguration<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> @<span class="title">interface</span> <span class="title">EnableWebMvc</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šä½¿è‡ªåŠ¨é…ç½®ç±»æ¡ä»¶ä¸æˆç«‹è€Œå¤±æ•ˆ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(WebMvcConfigurationSupport<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">TaskExecutionAutoConfiguration</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">		<span class="title">ValidationAutoConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">WebMvcAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å›½é™…åŒ–é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å›½é™…åŒ–èµ„æºè·¯å¾„</span></span><br><span class="line"><span class="meta">spring.messages.basename</span>=<span class="string">i18n.index</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰Localeè§£æå™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocaleResolver</span> <span class="keyword">implements</span> <span class="title">LocaleResolver</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Locale <span class="title">resolveLocale</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String localeStr = request.getParameter(<span class="string">"locale"</span>);</span><br><span class="line">        logger.info(<span class="string">"locale"</span>, localeStr);</span><br><span class="line">        <span class="keyword">if</span>(localeStr!=<span class="keyword">null</span> &amp;&amp; !StringUtils.isEmpty(localeStr))&#123;</span><br><span class="line">            String[] split = localeStr.split(<span class="string">"_"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Locale(split[<span class="number">0</span>], split[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Locale.getDefault();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h4 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h4><blockquote>
<p>springbootå¯æ ¹æ®ä¸åŒçš„è®¿é—®è®¾å¤‡è¿”å›ä¸åŒçš„é”™è¯¯ä¿¡æ¯ htmlæˆ–json</p>
<p>æ ¹æ®è¯·æ±‚å¤´åˆ¤æ–­åº”è¯¥è¿”å›å“åº”ç±»å‹</p>
</blockquote>
<ul>
<li><p>è‡ªåŠ¨é…ç½®</p>
<p>springbooté€šè¿‡<strong>ErrorMvcAutoConfiguration</strong>è‡ªåŠ¨é…ç½®é”™è¯¯é¡µé¢</p>
<p>ä¸»è¦é€šè¿‡æ·»åŠ ä»¥ä¸‹ç»„ä»¶å¯¹é”™è¯¯è¿›è¡Œå¤„ç†</p>
<ul>
<li><p>DefaultErrorAttributes</p>
<p>é¡µé¢é”™è¯¯ä¿¡æ¯</p>
</li>
<li><p>BasicErrorController</p>
<p>å¤„ç†/errorä¸‹çš„è¯·æ±‚</p>
</li>
<li><p>ErrorPageCustomizer</p>
<p>å®šåˆ¶é”™è¯¯é¡µé¢</p>
</li>
<li><p>DefaultErrorViewResolver</p>
<p>é”™è¯¯è§†å›¾è§£æå™¨</p>
</li>
</ul>
</li>
<li><p>å®šåˆ¶é”™è¯¯é¡µé¢</p>
<ul>
<li><p>é”™è¯¯é¡µé¢</p>
<p>åœ¨æœ‰æ¨¡æ¿è§£æçš„æƒ…å†µä¸‹ å¯åœ¨æ¨¡æ¿ç›®å½•æ”¾ä¸Šerror/çŠ¶æ€ç .html é”™è¯¯é¡µé¢  æˆ– 4xx 5xx æ¨¡ç³ŠåŒ¹é… å¯è·å–é”™è¯¯ä¿¡æ¯</p>
<p>å¦‚æœæ²¡æœ‰æ¨¡æ¿å¼•æ“ åœ¨é™æ€èµ„æºç›®å½•ä¸‹æ‰¾</p>
<p>å¦‚æœéƒ½æ²¡æœ‰ æ¥åˆ°é»˜è®¤é”™è¯¯é¡µé¢</p>
</li>
<li><p>json</p>
<p>éœ€è¦è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨ è¿”å›jsonæ•°æ®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªèƒ½è¿”å›jsonæ•°æ®</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(RuntimeException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">Map</span>&lt;<span class="title">String</span>, <span class="title">Object</span>&gt; <span class="title">handleException</span>(<span class="title">Throwable</span> <span class="title">error</span>)</span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"status"</span>, <span class="string">"error"</span>);</span><br><span class="line">        map.put(<span class="string">"message"</span>, error.getMessage());</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>é”™è¯¯é¡µé¢ä¸jsonå…±å­˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler</span>(RuntimeException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">String</span> <span class="title">handleException</span>(<span class="title">HttpServletRequest</span> <span class="title">request</span>, <span class="title">Throwable</span> <span class="title">error</span>)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    request.setAttribute(<span class="string">"javax.servlet.error.status_code"</span>, <span class="number">500</span>);</span><br><span class="line">    map.put(<span class="string">"status"</span>, <span class="string">"error"</span>);</span><br><span class="line">    map.put(<span class="string">"message"</span>, <span class="string">"error"</span>);</span><br><span class="line">    <span class="comment">// æ·»åŠ é”™è¯¯ä¿¡æ¯ å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ErrorAttributeå–å‡ºå¹¶æ”¾å…¥</span></span><br><span class="line">    request.setAttribute(<span class="string">"ext"</span>, map);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"forward:/error"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>è‡ªå®šä¹‰ErrorAttribute</p>
<p>é€šè¿‡è‡ªå®šä¹‰ErrorAttributeså¯ä»¥æ”¾å…¥è‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyErrorAttributes</span> <span class="keyword">extends</span> <span class="title">DefaultErrorAttributes</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getErrorAttributes</span><span class="params">(WebRequest webRequest, <span class="keyword">boolean</span> includeStackTrace)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">super</span>.getErrorAttributes(webRequest, includeStackTrace);</span><br><span class="line">        <span class="comment">// å°†è‡ªå®šä¹‰é”™è¯¯å¤„ç†å™¨ä¸­çš„é™„åŠ é”™è¯¯ä¿¡æ¯å–å‡º</span></span><br><span class="line">        map.put(<span class="string">"ext"</span>,webRequest.getAttribute(<span class="string">"ext"</span>, RequestAttributes.SCOPE_REQUEST));</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h2 id="å®šåˆ¶åŒ–WEBå®¹å™¨"><a href="#å®šåˆ¶åŒ–WEBå®¹å™¨" class="headerlink" title="å®šåˆ¶åŒ–WEBå®¹å™¨"></a>å®šåˆ¶åŒ–WEBå®¹å™¨</h2><blockquote>
<p>springbootæ”¯æŒå¤šç§webåµŒå…¥å¼å®¹å™¨ é€šè¿‡starteræ–¹å¼å¼•å…¥</p>
<p>é»˜è®¤ä¸ºtomcat</p>
</blockquote>
<h3 id="å®¹å™¨é…ç½®"><a href="#å®¹å™¨é…ç½®" class="headerlink" title="å®¹å™¨é…ç½®"></a>å®¹å™¨é…ç½®</h3><blockquote>
<p>ä¿®æ”¹å„ä¸ªå®¹å™¨çš„é…ç½®</p>
</blockquote>
<ul>
<li><p>åŸºæœ¬é…ç½®ç±»</p>
<p>æ‰€æœ‰çš„å®¹å™¨é…ç½®éƒ½åœ¨æ­¤ å„ä¸ªå®¹å™¨çš„é…ç½®é€šè¿‡é™æ€å†…éƒ¨ç±»çš„å½¢å¼å±•ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@AutoConfigureOrder</span>(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(ServletRequest<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnWebApplication</span>(<span class="title">type</span> </span>= Type.SERVLET)</span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(ServerProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">// å¯¼å…¥å„ä¸ªå®¹å™¨çš„é…ç½®ç±»</span></span><br><span class="line"><span class="class">@<span class="title">Import</span>(</span>&#123; ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">		<span class="title">ServletWebServerFactoryConfiguration</span>.<span class="title">EmbeddedTomcat</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">		<span class="title">ServletWebServerFactoryConfiguration</span>.<span class="title">EmbeddedJetty</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">		<span class="title">ServletWebServerFactoryConfiguration</span>.<span class="title">EmbeddedUndertow</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ServletWebServerFactoryAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®¹å™¨é…ç½®(ä»¥tomcatä¸ºä¾‹)</p>
<ul>
<li><p>é…ç½®æ–‡ä»¶</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="attr">uri-encoding:</span> <span class="string">UTF-8</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®ç±»</p>
<p>å¯é€šè¿‡è‡ªå®šä¹‰<strong>WebServerFactoryCustomizer</strong>é…ç½®ç±»è¿›è¡Œå®šåˆ¶åŒ–é…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServletContainerCustomizer</span>  <span class="keyword">implements</span> <span class="title">WebServerFactoryCustomizer</span>&lt;<span class="title">ConfigurableServletWebServerFactory</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(ConfigurableServletWebServerFactory factory)</span> </span>&#123;</span><br><span class="line">        factory.setPort(<span class="number">3323</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>å®¹å™¨è‡ªåŠ¨é…ç½®åŸç†</p>
<p>é€šè¿‡beanåç½®å¤„ç†å™¨æ³¨å†Œå™¨å‘å®¹å™¨ä¸­æ³¨å†Œ<strong>WebServerFactoryCustomizerBeanPostProcessor</strong> å®¹å™¨å®šåˆ¶åŒ–å™¨åç½®å¤„ç†å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanPostProcessorsRegistrar</span> <span class="keyword">implements</span> <span class="title">ImportBeanDefinitionRegistrar</span>, <span class="title">BeanFactoryAware</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata,</span></span></span><br><span class="line"><span class="function"><span class="params">                                        BeanDefinitionRegistry registry)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.beanFactory == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        registerSyntheticBeanIfMissing(registry, <span class="string">"webServerFactoryCustomizerBeanPostProcessor"</span>,</span><br><span class="line">                                       WebServerFactoryCustomizerBeanPostProcessor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        registerSyntheticBeanIfMissing(registry, <span class="string">"errorPageRegistrarBeanPostProcessor"</span>,</span><br><span class="line">                                       ErrorPageRegistrarBeanPostProcessor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨å®¹å™¨å®šåˆ¶åŒ–å™¨ä¸­ åº”ç”¨æ¯ä¸ªå®šåˆ¶åŒ–å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (bean <span class="keyword">instanceof</span> WebServerFactory) &#123;</span><br><span class="line">			postProcessBeforeInitialization((WebServerFactory) bean);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> bean;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">postProcessBeforeInitialization</span><span class="params">(WebServerFactory webServerFactory)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// éå†å¹¶åº”ç”¨æ¯ä¸ªå®šåˆ¶åŒ–å™¨</span></span><br><span class="line">    LambdaSafe.callbacks(WebServerFactoryCustomizer<span class="class">.<span class="keyword">class</span>, <span class="title">getCustomizers</span>(), <span class="title">webServerFactory</span>)</span></span><br><span class="line"><span class="class">        .<span class="title">withLogger</span>(<span class="title">WebServerFactoryCustomizerBeanPostProcessor</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">        .<span class="title">invoke</span>((<span class="title">customizer</span>) -&gt; <span class="title">customizer</span>.<span class="title">customize</span>(<span class="title">webServerFactory</span>))</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»beanå·¥å‚ä¸­è·å–æ‰€æœ‰å®¹å™¨å®šåˆ¶å™¨ç±»</span></span><br><span class="line"><span class="keyword">private</span> Collection&lt;WebServerFactoryCustomizer&lt;?&gt;&gt; getWebServerFactoryCustomizerBeans() &#123;</span><br><span class="line">    <span class="keyword">return</span> (Collection) <span class="keyword">this</span>.beanFactory.getBeansOfType(WebServerFactoryCustomizer<span class="class">.<span class="keyword">class</span>, <span class="title">false</span>, <span class="title">false</span>).<span class="title">values</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®¹å™¨å¯åŠ¨è¿‡ç¨‹</p>
<p><strong>ServletWebServerApplicationContext</strong>å®¹å™¨åˆå§‹åŒ–åœ¨è°ƒç”¨onRefreshæ–¹æ³•æ—¶ä¼šå¯åŠ¨å®¹å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onRefresh();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        createWebServer();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Unable to start web server"</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<p><strong>createWebServer()</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.webServer = factory.getWebServer(getSelfInitializer()); <span class="comment">// å®¹å™¨å·¥å‚åˆ›å»ºå®¹å™¨</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆè°ƒç”¨<strong>initialize()</strong>æ–¹æ³•å®Œæˆå®¹å™¨çš„å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Start the server to trigger initialization listeners</span></span><br><span class="line"><span class="keyword">this</span>.tomcat.start();</span><br></pre></td></tr></table></figure>


<h3 id="æ³¨å†Œä¸‰å¤§ç»„ä»¶"><a href="#æ³¨å†Œä¸‰å¤§ç»„ä»¶" class="headerlink" title="æ³¨å†Œä¸‰å¤§ç»„ä»¶"></a>æ³¨å†Œä¸‰å¤§ç»„ä»¶</h3><blockquote>
<p>springbootæ”¯æŒæ³¨å†Œä¸‰å¤§ç»„ä»¶ filter listener</p>
</blockquote>
<ul>
<li><p>servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">ServletRegistrationBean&lt;HttpServlet&gt; <span class="title">servletRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ServletRegistrationBean&lt;HttpServlet&gt; bean = <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;();</span><br><span class="line">    bean.setServlet(<span class="keyword">new</span> MyServlet());</span><br><span class="line">    bean.addUrlMappings(<span class="string">"/servlet"</span>);</span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>filter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">FilterRegistrationBean&lt;HttpFilter&gt; <span class="title">filterFilterRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FilterRegistrationBean&lt;HttpFilter&gt; registrationBean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;();</span><br><span class="line">    registrationBean.setFilter(<span class="keyword">new</span> MyFilter());</span><br><span class="line">    registrationBean.addUrlPatterns(<span class="string">"/*"</span>);</span><br><span class="line">    <span class="keyword">return</span> registrationBean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>listener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">ServletListenerRegistrationBean&lt;MySeesionListener&gt; <span class="title">seesionListenerServletListenerRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ServletListenerRegistrationBean&lt;MySeesionListener&gt; seesionListenerServletListenerRegistrationBean = <span class="keyword">new</span> ServletListenerRegistrationBean&lt;&gt;();</span><br><span class="line">    seesionListenerServletListenerRegistrationBean.setListener(<span class="keyword">new</span> MySeesionListener());</span><br><span class="line">    <span class="keyword">return</span> seesionListenerServletListenerRegistrationBean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="åˆ‡æ¢webå®¹å™¨"><a href="#åˆ‡æ¢webå®¹å™¨" class="headerlink" title="åˆ‡æ¢webå®¹å™¨"></a>åˆ‡æ¢webå®¹å™¨</h3><blockquote>
<p>springbootæ”¯æŒåˆ‡æ¢å®¹å™¨</p>
<p>é€šè¿‡starteræ–¹å¼åˆ‡æ¢å®¹å™¨</p>
<p>é»˜è®¤ä¸ºtomcat</p>
</blockquote>
<ol>
<li><p>æ’é™¤é»˜è®¤å®¹å™¨</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¼•å…¥å…¶ä»–å®¹å™¨</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- jetty --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- undertow ä¸æ”¯æŒjsp --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="ä½¿ç”¨å¤–éƒ¨å®¹å™¨"><a href="#ä½¿ç”¨å¤–éƒ¨å®¹å™¨" class="headerlink" title="ä½¿ç”¨å¤–éƒ¨å®¹å™¨"></a>ä½¿ç”¨å¤–éƒ¨å®¹å™¨</h4><blockquote>
<p>é€šè¿‡æ‰“waråŒ…çš„æ–¹å¼ ä½¿ç”¨å¤–éƒ¨å®¹å™¨</p>
<p>é€šè¿‡servlet3.0çš„spiæ¨¡å¼  åœ¨tomcatå¯åŠ¨æ—¶ é€šè¿‡<strong>@HandlesTypes</strong>æ³¨è§£æŸ¥æ‰¾<strong>WebApplicationInitializer</strong> çš„å®ç°ç±»è¿›è¡Œ<strong>DispatcherServlet</strong>å’Œå®¹å™¨çš„åˆå§‹åŒ–</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HandlesTypes</span>(WebApplicationInitializer<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringServletContainerInitializer</span> <span class="keyword">implements</span> <span class="title">ServletContainerInitializer</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ¯ä¸€ä¸ª<strong>WebApplicationInitializer</strong> çš„<strong>onStartup</strong>æ–¹æ³• å®Œæˆåˆå§‹åŒ–</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (WebApplicationInitializer initializer : initializers) &#123;</span><br><span class="line">    initializer.onStartup(servletContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¯åŠ¨è¿‡ç¨‹ å…ˆå¯åŠ¨å®¹å™¨ å†å¯åŠ¨åº”ç”¨</p>
<p>å°†ä¸»å¯åŠ¨ç±»æ·»åŠ è‡³åº”ç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletInitializer</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder application)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> application.sources(SpringbootWebappApplication<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>onStartupæ–¹æ³•åˆ›å»ºiocå®¹å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootServletInitializer</span> <span class="keyword">implements</span> <span class="title">WebApplicationInitializer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartup</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        WebApplicationContext rootAppContext = createRootApplicationContext(servletContext);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨åº”ç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">createRootApplicationContext</span><span class="params">(ServletContext servletContext)</span> </span>&#123;</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">    builder = configure(builder);</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> run(application);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h2 id="æ•°æ®è®¿é—®"><a href="#æ•°æ®è®¿é—®" class="headerlink" title="æ•°æ®è®¿é—®"></a>æ•°æ®è®¿é—®</h2><blockquote>
<p>springboot é€šè¿‡starterçš„æ–¹å¼ å¼•å…¥æŒä¹…å±‚æ¡†æ¶ ä¸spring dataé›†æˆ</p>
</blockquote>
<h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><blockquote>
<p>åŸºæœ¬çš„jdbcé…ç½® ä½¿ç”¨æ•°æ®æº</p>
</blockquote>
<ul>
<li><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jdbcé©±åŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿æ¥é…ç½®</p>
<p>é»˜è®¤ä½¿ç”¨<strong>com.zaxxer.hikari.HikariDataSource</strong>(springboot 2.x) ä½œä¸ºæ•°æ®æº</p>
<p>springbootå†…ç½®æ”¯æŒ Tomcat Hikari DBCP æ•°æ®æº  è¿˜å¯é€šè¿‡<strong>spring.datasource.type</strong> æŒ‡å®šè‡ªå·±çš„æ•°æ®æº</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin123</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/test?serverTimezone=Asia/Shanghai</span></span><br></pre></td></tr></table></figure>

<p>å¯¹äºè‡ªå®šä¹‰æ•°æ®æº é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ å¹¶ç»‘å®šé…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(DataSource<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnProperty</span>(<span class="title">name</span> </span>= <span class="string">"spring.datasource.type"</span>)</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Generic</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">DataSource <span class="title">dataSource</span><span class="params">(DataSourceProperties properties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> properties.initializeDataSourceBuilder().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ•°æ®æºåˆå§‹åŒ–</p>
<p>é€šè¿‡springçš„äº‹ä»¶ç›‘å¬æœºåˆ¶ å¯¹æ•°æ®æºè¿›è¡Œåˆå§‹åŒ–</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataSourceInitializerInvoker</span> <span class="keyword">implements</span> <span class="title">ApplicationListener</span>&lt;<span class="title">DataSourceSchemaCreatedEvent</span>&gt;, <span class="title">InitializingBean</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>åœ¨beançš„æ‰€æœ‰å±æ€§å¤èµ‹å€¼åè°ƒç”¨initializeåˆå§‹åŒ–æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DataSourceInitializer initializer = getDataSourceInitializer();</span><br><span class="line">    <span class="keyword">if</span> (initializer != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> schemaCreated = <span class="keyword">this</span>.dataSourceInitializer.createSchema();</span><br><span class="line">        <span class="keyword">if</span> (schemaCreated) &#123;</span><br><span class="line">            initialize(initializer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆå§‹åŒ–æ—¶æ‰§è¡Œæ‰€æœ‰çš„sqlè„šæœ¬</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">(DataSourceInitializer initializer)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//..</span></span><br><span class="line">    <span class="comment">// å‘å¸ƒäº‹ä»¶</span></span><br><span class="line">    <span class="keyword">this</span>.applicationContext.publishEvent(<span class="keyword">new</span> DataSourceSchemaCreatedEvent(initializer.getDataSource()));</span><br><span class="line">    <span class="comment">// The listener might not be registered yet, so don't rely on it.</span></span><br><span class="line">    <span class="keyword">this</span>.dataSourceInitializer.initSchema();</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>initSchema æ‰§è¡Œæ‰€æœ‰è„šæœ¬</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initSchema</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰è„šæœ¬æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    List&lt;Resource&gt; scripts = getScripts(<span class="string">"spring.datasource.data"</span>, <span class="keyword">this</span>.properties.getData(), <span class="string">"data"</span>);</span><br><span class="line">        <span class="comment">// ..</span></span><br><span class="line">        runScripts(scripts, username, password);</span><br><span class="line">        <span class="comment">// ..</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>äº‹ä»¶å‘ç”Ÿæ—¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(DataSourceSchemaCreatedEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// NOTE the event can happen more than once and</span></span><br><span class="line">    <span class="comment">// the event datasource is not used </span></span><br><span class="line">    DataSourceInitializer initializer = getDataSourceInitializer();</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.initialized &amp;&amp; initializer != <span class="keyword">null</span>) &#123;</span><br><span class="line">        initializer.initSchema();</span><br><span class="line">        <span class="keyword">this</span>.initialized = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ç”¨å¯åŠ¨æ—¶æ‰§è¡Œsqlè„šæœ¬</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ç”¨è„šæœ¬æ‰§è¡Œ å¦‚æœALWAYS ä¼šæŸ¥æ‰¾ç±»è·¯å¾„ä¸‹çš„schema.*.sql å’Œdata.*.sql å»ºè¡¨å’Œå‡ºæ’å…¥æ•°æ®</span></span><br><span class="line"><span class="meta">spring.datasource.initialization-mode</span>=<span class="string">ALWAYS</span></span><br><span class="line"><span class="comment"># æŒ‡å®šsqlæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># æ‰§è¡Œå»ºè¡¨è¯­å¥ </span></span><br><span class="line"><span class="meta">spring.datasource.schema</span>=<span class="string">classpath:schema.sql</span></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ’å…¥è¯­å¥ </span></span><br><span class="line"><span class="meta">spring.datasource.data</span>=<span class="string">classpath:data.sql</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>JdbcTemplate</p>
<p>è‡ªåŠ¨é…ç½®äº†JdbcTemplateå’ŒNamedParameterJdbcTemplate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="function">NamedParameterJdbcTemplate <span class="title">namedParameterJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> NamedParameterJdbcTemplate(jdbcTemplate);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="function">JdbcTemplate <span class="title">jdbcTemplate</span><span class="params">(DataSource dataSource, JdbcProperties properties)</span> </span>&#123;</span><br><span class="line">    JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line">    JdbcProperties.Template template = properties.getTemplate();</span><br><span class="line">    jdbcTemplate.setFetchSize(template.getFetchSize());</span><br><span class="line">    jdbcTemplate.setMaxRows(template.getMaxRows());</span><br><span class="line">    <span class="keyword">if</span> (template.getQueryTimeout() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        jdbcTemplate.setQueryTimeout((<span class="keyword">int</span>) template.getQueryTimeout().getSeconds());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="æ•°æ®æºç›‘æ§"><a href="#æ•°æ®æºç›‘æ§" class="headerlink" title="æ•°æ®æºç›‘æ§"></a>æ•°æ®æºç›‘æ§</h3><blockquote>
<p>Druidæ•°æ®æºæä¾›åŸºäºservletçš„ç›‘æ§åŠŸèƒ½</p>
</blockquote>
<ul>
<li><p>å¼•å…¥druid starter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ•°æ®æºç›‘æ§é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨æˆ·åå¯†ç </span></span><br><span class="line"><span class="meta">spring.datasource.druid.stat-view-servlet.login-username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.druid.stat-view-servlet.login-password</span>=<span class="string">admin123</span></span><br><span class="line"><span class="comment"># æ˜¯å¦å¯ç”¨</span></span><br><span class="line"><span class="meta">spring.datasource.druid.stat-view-servlet.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># ç›‘æ§é¡µé¢å…¥å£</span></span><br><span class="line"><span class="meta">spring.datasource.druid.stat-view-servlet.url-pattern</span>=<span class="string">/druid/*</span></span><br><span class="line"><span class="meta">spring.datasource.druid.web-stat-filter.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># è·¯å¾„æ’é™¤</span></span><br><span class="line"><span class="meta">spring.datasource.druid.web-stat-filter.exclusions</span>=<span class="string">*.css,*.js,/druid/*</span></span><br><span class="line"><span class="comment"># è¿‡æ»¤å™¨æ‹¦æˆªè·¯å¾„</span></span><br><span class="line"><span class="meta">spring.datasource.druid.web-stat-filter.url-pattern</span>=<span class="string">/*</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="æ•´åˆMyBatis"><a href="#æ•´åˆMyBatis" class="headerlink" title="æ•´åˆMyBatis"></a>æ•´åˆMyBatis</h3><blockquote>
<p>springbooté€šè¿‡starterçš„æ–¹å¼å¼•å…¥MyBatisè‡ªåŠ¨é…ç½®</p>
</blockquote>
<ul>
<li><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå®šä¹‰é…ç½®</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">cache-enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå®šä¹‰é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mapperæ‰«æ</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.yong.springboot.mapper"</span>)</span><br><span class="line"><span class="meta">@org</span>.springframework.context.annotation.Configuration</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function">ConfigurationCustomizer <span class="title">configurationCustomizer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ConfigurationCustomizer() &#123;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(Configuration configuration)</span> </span>&#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">				configuration.setMapUnderscoreToCamelCase(<span class="keyword">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªåŠ¨é…ç½®</p>
<blockquote>
<p>springbootè‡ªåŠ¨é…ç½®å¥½äº† <strong>SqlSessionFactory</strong>  <strong>SqlSessionTemplate</strong> <strong>MapperScannerConfigurer</strong> </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.springframework.context.annotation.Configuration</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(&#123; SqlSessionFactory<span class="class">.<span class="keyword">class</span>, <span class="title">SqlSessionFactoryBean</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnSingleCandidate</span>(<span class="title">DataSource</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">MybatisProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">AutoConfigureAfter</span>(</span>&#123; DataSourceAutoConfiguration<span class="class">.<span class="keyword">class</span>, <span class="title">MybatisLanguageDriverAutoConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">MybatisAutoConfiguration</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span> </span>&#123;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="Mapper-é…ç½®"><a href="#Mapper-é…ç½®" class="headerlink" title="Mapper é…ç½®"></a>Mapper é…ç½®</h4><ul>
<li><p>æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from t_user"</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yong.springboot.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span>&gt;</span></span><br><span class="line">    select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®æ˜ å°„å’Œé…ç½®æ–‡ä»¶è·¯å¾„</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">check-config-location:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">config-location:</span> <span class="string">classpath:mybatis-config.xml</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:com/yong/springboot/mapper/*.xml</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="JPA"><a href="#JPA" class="headerlink" title="JPA"></a>JPA</h3><blockquote>
<p>spring data jpa æä¾›å¯¹å…³ç³»å‹æ•°æ®åº“çš„ç»Ÿä¸€API ç®€åŒ–æ“ä½œ åº•å±‚ä½¿ç”¨hibernate</p>
<p>JPAæ˜¯JSR107è§„èŒƒ ç”¨äºç®€åŒ–æŒä¹…å±‚å¼€å‘</p>
</blockquote>
<h4 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h4><ul>
<li>å¯¼å…¥ä¾èµ–</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>é…ç½®æ–‡ä»¶</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<h4 id="æ³¨è§£å…³ç³»æ˜ å°„"><a href="#æ³¨è§£å…³ç³»æ˜ å°„" class="headerlink" title="æ³¨è§£å…³ç³»æ˜ å°„"></a>æ³¨è§£å…³ç³»æ˜ å°„</h4><blockquote>
<p>ä½¿ç”¨æ³¨è§£å®Œæˆå®ä½“ç±»çš„æ•°æ®åº“å…³ç³»éšå°„</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"t_emp"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="comment">// ä¸»é”®</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy=GenerationType.IDENTITY) <span class="comment">// è‡ªå¢</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="meta">@Column</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="meta">@Column</span> <span class="comment">// åˆ—</span></span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	<span class="meta">@Column</span></span><br><span class="line">	<span class="keyword">private</span> Integer deptId;</span><br></pre></td></tr></table></figure>

<h4 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h4><blockquote>
<p>spring data jpa æä¾›ç»Ÿä¸€çš„CRUDæ¥å£</p>
</blockquote>
<p>é¡¶å±‚æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Indexed</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Repository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CRUDæ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoRepositoryBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CrudRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; <span class="keyword">extends</span> <span class="title">Repository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; </span>&#123;</span><br></pre></td></tr></table></figure>

<p>åˆ†é¡µæ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoRepositoryBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PagingAndSortingRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; <span class="keyword">extends</span> <span class="title">CrudRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; </span>&#123;</span><br></pre></td></tr></table></figure>

<p>JPAæ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoRepositoryBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JpaRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt; <span class="keyword">extends</span> <span class="title">PagingAndSortingRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt;, <span class="title">QueryByExampleExecutor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Daoå®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Employee</span>, <span class="title">Integer</span>&gt; </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="è‡ªå®šä¹‰starter"><a href="#è‡ªå®šä¹‰starter" class="headerlink" title="è‡ªå®šä¹‰starter"></a>è‡ªå®šä¹‰starter</h2><blockquote>
<p>å¯æŒ‰ç…§springbootçš„è‡ªåŠ¨é…ç½®è§„èŒƒ è‡ªå®šä¹‰starter</p>
<p>ä¸€èˆ¬çš„starterç”± starterä¸autoconfigurerä¸¤éƒ¨åˆ†ç»„æˆ</p>
<p>starterä¾èµ–autoconfigurer</p>
<p>ä½¿ç”¨æ—¶åªéœ€å¯¼å…¥starter</p>
</blockquote>
<ul>
<li><p>æ–°å»ºbooté¡¹ç›®autoconfigure å¼•å…¥å”¯ä¸€ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å»ºç©ºmavené¡¹ç›®starter å¼•å…¥autoconfigure</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.yong<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>magic-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç±»è·¯å¾„ä¸‹æ–°å»ºWEB-INF/spring.factories å°†è‡ªåŠ¨é…ç½®ç±»å¼•å…¥ åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šæŸ¥æ‰¾è¯¥ç±»å¹¶åŠ å…¥iocå®¹å™¨</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="attr">com.yong.spring.boot.autoconfigure.MagicAutoConfigure</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<h2 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h2><blockquote>
<p>springbootæä¾›äº†ç»Ÿä¸€çš„ç¼“å­˜æ¥å£(Spring Data)  ä¸JSR107è§„èŒƒç±»ä¼¼ æ›´æ˜“äºä½¿ç”¨</p>
</blockquote>
<h3 id="starter"><a href="#starter" class="headerlink" title="starter"></a>starter</h3><blockquote>
<p>springbooté€šè¿‡starterçš„æ–¹å¼å¼•å…¥ç¼“å­˜æ”¯æŒ</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è‡ªåŠ¨é…ç½®</p>
<blockquote>
<p>springbootæä¾›äº†å¯¹ç¼“å­˜çš„è‡ªåŠ¨é…ç½®</p>
</blockquote>
<p>ä¸»è¦æ”¯æŒå¦‚ä¸‹ç¼“å­˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mappings.put(CacheType.GENERIC, GenericCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.EHCACHE, EhCacheCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.HAZELCAST, HazelcastCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.INFINISPAN, InfinispanCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.JCACHE, JCacheCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.COUCHBASE, CouchbaseCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.REDIS, RedisCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.CAFFEINE, CaffeineCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.SIMPLE, SimpleCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">mappings.put(CacheType.NONE, NoOpCacheConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤SimpleCacheConfigurationç”Ÿæ•ˆ åº•å±‚ä½¿ç”¨<strong>ConcurrentHashMap</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(CacheManager<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Conditional</span>(<span class="title">CacheCondition</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">SimpleCacheConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">ConcurrentMapCacheManager <span class="title">cacheManager</span><span class="params">(CacheProperties cacheProperties,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           CacheManagerCustomizers cacheManagerCustomizers)</span> </span>&#123;</span><br><span class="line">        ConcurrentMapCacheManager cacheManager = <span class="keyword">new</span> ConcurrentMapCacheManager();</span><br><span class="line">        List&lt;String&gt; cacheNames = cacheProperties.getCacheNames();</span><br><span class="line">        <span class="keyword">if</span> (!cacheNames.isEmpty()) &#123;</span><br><span class="line">            cacheManager.setCacheNames(cacheNames);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cacheManagerCustomizers.customize(cacheManager);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Cacheableæ–¹æ³•æ‰§è¡Œå‰  ä¼šå…ˆå°è¯•è·å–ç¼“å­˜æ—¶æŒ‰ç…§cacheNamesè·å–Cacheç»„ä»¶ å¦‚æœä¸å­˜åœ¨ä¼šåˆ›å»ºç¼“å­˜å¹¶å°†æ–¹æ³•çš„è¿”å›ç»“æœæ”¾å…¥ç¼“å­˜ æ•´ä½“é€šè¿‡AOPå®ç° é»˜è®¤ä½¿ç”¨SimpleKeyGenerator</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Cache <span class="title">getCache</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    Cache cache = <span class="keyword">this</span>.cacheMap.get(name);</span><br><span class="line">    <span class="keyword">if</span> (cache == <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.dynamic) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>.cacheMap) &#123;</span><br><span class="line">            cache = <span class="keyword">this</span>.cacheMap.get(name);</span><br><span class="line">            <span class="keyword">if</span> (cache == <span class="keyword">null</span>) &#123;</span><br><span class="line">                cache = createConcurrentMapCache(name);</span><br><span class="line">                <span class="keyword">this</span>.cacheMap.put(name, cache);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="æ³¨è§£é©±åŠ¨ç¼“å­˜"><a href="#æ³¨è§£é©±åŠ¨ç¼“å­˜" class="headerlink" title="æ³¨è§£é©±åŠ¨ç¼“å­˜"></a>æ³¨è§£é©±åŠ¨ç¼“å­˜</h3><blockquote>
<p>æ³¨è§£æ–¹å¼é…ç½®ç¼“å­˜</p>
<p>éœ€è¦åœ¨é…ç½®ç±»ä¸­å¼€å¯@EnableCachingæ³¨è§£é©±åŠ¨ç¼“å­˜</p>
</blockquote>
<ul>
<li><p>@Cacheable</p>
<p>ç¼“å­˜æ–¹æ³•çš„è¿”å›å€¼ </p>
<p>å‚æ•°ä¸€è§ˆ ç¬¬äºŒæ¬¡ä¸ä¼šæ‰§è¡Œç›´æ¥èµ°ç¼“å­˜</p>
<ul>
<li><p>cacheNames/value æŒ‡å®šç¼“å­˜ç»„ä»¶çš„åå­—</p>
</li>
<li><p>key ç¼“å­˜æ•°æ®ä½¿ç”¨çš„key é»˜è®¤ä½¿ç”¨æ–¹æ³•å‚æ•°å€¼ 1 ä½¿ç”¨æ–¹æ³•çš„è¿”å›å€¼ å¯å†™SpEL </p>
<p>#root.methodName å½“å‰æ–¹æ³•å</p>
<p>#root.method å½“å‰æ–¹æ³•</p>
<p>#root.args  å½“å‰æ–¹æ³•çš„å‚æ•°åˆ—è¡¨</p>
<p>#root.target å½“å‰è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡</p>
<p>#root.targetClass å½“å‰è°ƒç”¨æ–¹æ³•æ‰€å±çš„ç±»</p>
<p>#root.caches å½“å‰æ–¹æ³•ä½¿ç”¨çš„ç¼“å­˜åˆ—è¡¨</p>
<p>#å‚æ•°å è·å–å‚æ•°å€¼</p>
<p>#result æ–¹æ³•è¿”å›ç»“æœ</p>
</li>
<li><p>keyGenerator keyç”Ÿæˆå™¨ å¯ä»¥è‡ªå·±æŒ‡å®škeyçš„ç”Ÿæˆå™¨ç»„ä»¶id ä¸keyäºŒé€‰ä¸€</p>
<p>è‡ªå®šä¹‰KeyGenerator</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">      <span class="function">KeyGenerator <span class="title">keyGenerator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> KeyGenerator() &#123;</span><br><span class="line">              <span class="meta">@Override</span></span><br><span class="line">              <span class="function"><span class="keyword">public</span> Object <span class="title">generate</span><span class="params">(Object target, Method method, Object... params)</span> </span>&#123;</span><br><span class="line">                  <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">                  <span class="keyword">return</span> method.getName()+<span class="string">"["</span>+Arrays.toString(params)+<span class="string">"]"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></code></pre></li>
</ul>
</li>
</ul>
<ul>
<li><p>cacheManager æŒ‡å®šç¼“å­˜ç®¡ç†å™¨</p>
</li>
<li><p>condition æŒ‡å®šç¬¦åˆæ¡ä»¶çš„æƒ…å†µä¸‹ç¼“å­˜</p>
</li>
<li><p>unless å¦å®šç¼“å­˜ å½“ä¸ºtrueæ—¶æ–¹æ³•çš„è¿”å›å€¼ä¸ä¼šè¢«ç¼“å­˜ å¯è·å–æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œåˆ¤æ–­</p>
</li>
<li><p>sync æ˜¯å¦å¼‚æ­¥ç¼“å­˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cacheable</span>(cacheNames= &#123;<span class="string">"emp"</span>&#125;, key=<span class="string">"#root.method"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> employeeDao.findAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<ul>
<li><p>@CachePut</p>
<p>æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ›´æ–°ç¼“å­˜</p>
<p>åº”è¯¥ä¸ç›¸åº”çš„æŸ¥è¯¢æ–¹æ³•ä½¿ç”¨ç›¸åŒçš„ç¼“å­˜æ‰èƒ½æ­£ç¡®è·Ÿæ–°ç¼“å­˜</p>
</li>
<li><p>@CacheEvict</p>
<p>åˆ é™¤ç¼“å­˜</p>
<ul>
<li>allEntries é»˜è®¤false æ˜¯å¦åˆ é™¤æ‰€æœ‰ç¼“å­˜</li>
<li>beforeInvocation é»˜è®¤false æ˜¯å¦å´½æ–¹æ³•æ‰§è¡Œå‰åˆ é™¤ å¦‚æœæ–¹æ³•æŠ›å¼‚å¸¸ ä¹‹åä¸ä¼šåˆ é™¤ç¼“å­˜</li>
</ul>
</li>
<li><p>@Caching å®šä¹‰å¤æ‚ç¼“å­˜è§„åˆ™</p>
</li>
<li><p>@CacheConfig å®šä¹‰å…¬å…±ç¼“å­˜é…ç½®</p>
</li>
</ul>
<h3 id="æ•´åˆRedis"><a href="#æ•´åˆRedis" class="headerlink" title="æ•´åˆRedis"></a>æ•´åˆRedis</h3><blockquote>
<p>é€šè¿‡starterçš„æ–¹å¼æ•´åˆRedisï¼ˆSpring data redisï¼‰</p>
</blockquote>
<ul>
<li><p>å¯¼å…¥starter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªåŠ¨é…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(RedisOperations<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">RedisProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Import</span>(</span>&#123; LettuceConnectionConfiguration<span class="class">.<span class="keyword">class</span>, <span class="title">JedisConnectionConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">RedisAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span>(name = <span class="string">"redisTemplate"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        <span class="comment">// é»˜è®¤é‡‡ç”¨JDKåºåˆ—åŒ–æœºåˆ¶ è¦æ±‚å®ä½“ç±»å®ç°Serializableæ¥å£</span></span><br><span class="line">        RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StringRedisTemplate <span class="title">stringRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        StringRedisTemplate template = <span class="keyword">new</span> StringRedisTemplate();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå®šä¹‰CacheManager å®ç°jsonåºåˆ—åŒ–  å¦‚æœå­˜åœ¨å¤šä¸ªCacheManager éœ€è¦ä½¿ç”¨@PrimaryæŒ‡å®šä¸€ä¸ªä¸»è¦CacheManager</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">RedisCacheManager <span class="title">empCacheManager</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> </span>&#123;</span><br><span class="line">    RedisCacheConfiguration defaultCacheConfiguration = RedisCacheConfiguration.defaultCacheConfig(); </span><br><span class="line">    defaultCacheConfiguration = defaultCacheConfiguration.serializeValuesWith(SerializationPair.fromSerializer(<span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee<span class="class">.<span class="keyword">class</span>)))</span>; <span class="comment">// ä½¿ç”¨jsonåºåˆ—åŒ–</span></span><br><span class="line">    RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(RedisCacheWriter.nonLockingRedisCacheWriter(redisConnectionFactory), defaultCacheConfiguration);</span><br><span class="line">    <span class="keyword">return</span> cacheManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="æ¶ˆæ¯ä¸­é—´ä»¶"><a href="#æ¶ˆæ¯ä¸­é—´ä»¶" class="headerlink" title="æ¶ˆæ¯ä¸­é—´ä»¶"></a>æ¶ˆæ¯ä¸­é—´ä»¶</h2><blockquote>
<p>springboot ä¸æ¶ˆæ¯é˜Ÿåˆ—æ•´åˆ</p>
<p>é€šè¿‡ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—  å¯ä»¥</p>
<p>å®ç°æ¶ˆæ¯çš„ç”Ÿäº§ä¸æ¶ˆè´¹å¼‚æ­¥æ‰§è¡Œ</p>
<p>å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡</p>
<p>ç¼“è§£åç«¯æœåŠ¡å‹åŠ›(æµé‡å‰Šé™)</p>
</blockquote>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote>
<p>é€šè¿‡ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶å¯ä»¥æå‡åº”ç”¨çš„å¼‚æ­¥é€šä¿¡ æ‰©å±•è§£è€¦èƒ½åŠ›</p>
</blockquote>
<ul>
<li><p>æ¶ˆæ¯æœåŠ¡</p>
<ul>
<li><p>æ¶ˆæ¯ä»£ç†</p>
<p>æ¶ˆæ¯å‘é€è€…å‘é€æ¶ˆæ¯å å°†ç”±æ¶ˆæ¯ä»£ç†æ¥ç®¡ æ¶ˆæ¯ä»£ç†ä¿è¯æ¶ˆæ¯ä¼ é€’åˆ°æŒ‡å®šç›®çš„åœ°</p>
</li>
<li><p>ç›®çš„åœ°</p>
<p>æ¶ˆæ¯æ¥æ”¶è€…</p>
<p>ç›®çš„åœ°çš„ä¸»è¦å½¢å¼æœ‰</p>
<ul>
<li>é˜Ÿåˆ— ç‚¹å¯¹ç‚¹æ¶ˆæ¯é€šä¿¡</li>
<li>ä¸»é¢˜ å‘å¸ƒ/è®¢é˜… æ¶ˆæ¯é€šä¿¡</li>
</ul>
</li>
</ul>
</li>
<li><p>æ¶ˆæ¯æœåŠ¡è§„èŒƒ</p>
<ul>
<li><p>JMS </p>
<p>åŸºäºJVMæ¶ˆæ¯ä»£ç†è§„èŒƒ</p>
<p>ä¾‹å¦‚ActiveMQ HornetMQ</p>
</li>
<li><p>AMQP </p>
<p>é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®® å…¼å®¹JMQ æ”¯æŒè·¨è¯­è¨€å’Œå¹³å°</p>
<p>ä¾‹å¦‚RabbitMQ</p>
</li>
</ul>
</li>
</ul>
<h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><blockquote>
<p>AMQPåè®®çš„æ¶ˆæ¯ä¸­é—´ä»¶</p>
</blockquote>
<ul>
<li><p>æ ¸å¿ƒæ¦‚å¿µ</p>
<ul>
<li><p>Message æ¶ˆæ¯  ç”±æ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ç»„æˆ</p>
</li>
<li><p>Publisher æ¶ˆæ¯ç”Ÿäº§è€…</p>
</li>
<li><p>Exchange äº¤æ¢å™¨ ç”¨äºå°†ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯äº¤ç»™æ¶ˆæ¯é˜Ÿåˆ—</p>
<p>æ¶ˆæ¯åˆ†å‘ç±»å‹</p>
<ul>
<li>direct è·¯ç”±é”®å®Œå…¨åŒ¹é… æ‰ä¼šæ´¾å‘åˆ°ç›¸åº”çš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>fanout å°†æ¶ˆæ¯æ´¾å‘åˆ°æ¯ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</li>
<li>topic è·¯ç”±é”®æ¨¡ç³ŠåŒ¹é… # åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå•è¯ * åŒ¹é…ä¸€ä¸ªå•è¯</li>
</ul>
</li>
<li><p>Queue æ¶ˆæ¯é˜Ÿåˆ— ä¿å­˜æ¶ˆæ¯çŸ¥é“å‘é€ç»™æ¶ˆè´¹è€…</p>
</li>
<li><p>Binding ç»‘å®š ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ä¸äº¤æ¢å™¨ä¹‹é—´çš„å…³è”  æ¶ˆæ¯å¤´çš„è·¯ç”±é”®ä¸é˜Ÿåˆ—çš„æ˜ å°„å…³ç³»</p>
</li>
<li><p>Conncection  TCPè¿æ¥</p>
</li>
<li><p>Channel ä¿¡é“  ç”¨äºå¤šè·¯å¤ç”¨ æ¶ˆæ¯ä¼ è¾“é€šè¿‡ä¿¡é“å®Œæˆ ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯æ‰¿è½½å¤šä¸ªä¿¡é“</p>
</li>
<li><p>Comsumer æ¶ˆè´¹è€… æ¶ˆæ¯çš„æ¥æ”¶è€…</p>
</li>
<li><p>Virtual Host è™šæ‹Ÿä¸»æœº è¡¨ç¤ºä¸€æ‰¹äº¤æ¢å™¨ æ¶ˆæ¯é˜Ÿåˆ— å’Œç›¸å…³å¯¹è±¡ æ¯ä¸ªè™šæ‹Ÿä¸»æœºç›¸äº’éš”ç¦»</p>
</li>
<li><p>Broker è¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“</p>
</li>
</ul>
</li>
<li><p>å®‰è£…</p>
<ol>
<li>å®˜ç½‘ä¸‹è½½å®‰è£…ç¨‹åº <a href="https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.8.2/rabbitmq-server-3.8.2.exe" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></li>
<li>ç‚¹å‡»å®‰è£…</li>
<li>cmdåˆ°å®‰è£…ç›®å½•/sbin</li>
<li>å®‰è£…webç®¡ç†æ’ä»¶ rabbitmq-plugins enable rabbitmq_management </li>
<li>å¯åŠ¨æœåŠ¡å™¨ rabbitmq-server</li>
<li>æµè§ˆå™¨è¾“å…¥ <a href="http://localhost:15672/" target="_blank" rel="noopener">http://localhost:15672/</a>   åˆå§‹ç”¨æˆ·åå¯†ç éƒ½ä¸ºguest</li>
</ol>
</li>
</ul>
<h4 id="springbootæ•´åˆ"><a href="#springbootæ•´åˆ" class="headerlink" title="springbootæ•´åˆ"></a>springbootæ•´åˆ</h4><ul>
<li><p>å¼•å…¥starter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªåŠ¨é…ç½®ç±»</p>
<p>å¯¼å…¥äº†</p>
<ul>
<li><p>CachingConnectionFactory è¿æ¥å·¥å‚</p>
</li>
<li><p>AmqpAdmin ç®¡ç†ç»„ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ é˜Ÿåˆ—</span></span><br><span class="line">Queue queue = <span class="keyword">new</span> Queue(<span class="string">"myqueue"</span>);</span><br><span class="line">amqpAdmin.declareQueue(queue);</span><br><span class="line"><span class="comment">// æ·»åŠ äº¤æ¢å™¨</span></span><br><span class="line">Exchange exchange = <span class="keyword">new</span> DirectExchange(<span class="string">""</span>);</span><br><span class="line">amqpAdmin.declareExchange(exchange);</span><br><span class="line"><span class="comment">//æ·»åŠ Binding</span></span><br><span class="line">Binding binding = <span class="keyword">new</span> Binding(<span class="string">"amqpadmin.main"</span>, DestinationType.QUEUE, <span class="string">"amqpadmin"</span>, <span class="string">"amqpadmin"</span>, <span class="keyword">null</span>);</span><br><span class="line">amqpAdmin.declareBinding(binding);</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>RabbitTemplate æ¶ˆæ¯æ“ä½œç»„ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; msg = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">msg.put(<span class="string">"msg"</span>, <span class="string">"from spring"</span>);</span><br><span class="line"><span class="comment">// å‘æŒ‡å®šäº¤æ¢å™¨å‘é€æ¶ˆæ¯</span></span><br><span class="line">rabbitTemplate.convertAndSend(<span class="string">"yong.main"</span>, <span class="string">"yong.main"</span>, msg);</span><br><span class="line"><span class="comment">// æ¥æ”¶æŒ‡å®šé˜Ÿåˆ—çš„æ¶ˆæ¯</span></span><br><span class="line">Object object = rabbitTemplate.receiveAndConvert(<span class="string">"main"</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<ul>
<li><p>äº‹ä»¶ç›‘å¬</p>
<p>å¼€å¯Rabbitæ³¨è§£é©±åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableRabbit</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootAmqpApplication</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>ç›‘å¬æŒ‡å®šé˜Ÿåˆ— ä¸€æ—¦æœ‰æ¶ˆæ¯ ç«‹å³è°ƒç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RabbitListener</span>(queues= &#123;<span class="string">"main"</span>&#125;)</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onReceived</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">    System.out.println(msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h2 id="å…¨æ–‡æ£€ç´¢"><a href="#å…¨æ–‡æ£€ç´¢" class="headerlink" title="å…¨æ–‡æ£€ç´¢"></a>å…¨æ–‡æ£€ç´¢</h2><blockquote>
<p>springbootæ•´åˆspring data elasticserach æä¾›æ£€ç´¢æ”¯æŒ</p>
</blockquote>
<h3 id="ElasticSerach"><a href="#ElasticSerach" class="headerlink" title="ElasticSerach"></a>ElasticSerach</h3><blockquote>
<p>ä¸€ç§åˆ†å¸ƒå¼æœç´¢æœåŠ¡ ä¸ºå¤§å‹åº”ç”¨æä¾›å…¨æ–‡æ£€ç´¢æ”¯æŒ åŸºäºRESTFull API å»ºç«‹åœ¨ Lucene ä¹‹ä¸Š</p>
<p>é€šè¿‡HTTPè¯·æ±‚å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨å’Œæ£€ç´¢</p>
<p>æ•°æ®é€šè¿‡æ–‡æ¡£çš„æ–¹å¼å‚¨å­˜ å¹¶é€šè¿‡ç´¢å¼•å’Œç±»å‹è¿›è¡Œå½’ç±»</p>
<p>PUT: æ·»åŠ å’Œæ›´æ–°</p>
<p>GET: è·å–</p>
<p>DELETE: åˆ é™¤ç´¢å¼•</p>
</blockquote>
<ul>
<li><p>å®‰è£…</p>
<ol>
<li>ä¸‹è½½å¹¶è§£å‹  <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.0-windows-x86_64.zip" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></li>
<li>cmdåˆ°è§£å‹ç›®å½•/bin è¿è¡Œelasticsearch.bat å¯åŠ¨</li>
<li>è®¿é—® <a href="http://localhost:9200" target="_blank" rel="noopener">http://localhost:9200</a> å¦‚æœå‡ºç°jsonåˆ™å®‰è£…æˆåŠŸ</li>
</ol>
</li>
<li><p>åŸºæœ¬æ“ä½œ</p>
<p>è¯¦æƒ…è¯·çœ‹<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
</li>
</ul>
<h4 id="springbootæ•´åˆ-1"><a href="#springbootæ•´åˆ-1" class="headerlink" title="springbootæ•´åˆ"></a>springbootæ•´åˆ</h4><blockquote>
<p>é€šè¿‡starterå®Œæˆæ•´åˆ</p>
<p>æä¾›ä¸¤ç§æ–¹å¼æ“ä½œes</p>
<ol>
<li>Jest</li>
<li>SpringData ElasticSearch</li>
</ol>
</blockquote>
<ul>
<li><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªåŠ¨é…ç½®</p>
<p>jest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(JestClient<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">JestProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">AutoConfigureAfter</span>(<span class="title">GsonAutoConfiguration</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Deprecated</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">JestAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>rest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(RestClient<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">RestClientProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Import</span>(</span>&#123; RestClientConfigurations.RestClientBuilderConfiguration<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">         <span class="title">RestClientConfigurations</span>.<span class="title">RestHighLevelClientConfiguration</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">         <span class="title">RestClientConfigurations</span>.<span class="title">RestClientFallbackConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">RestClientAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>spring data</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(&#123; ElasticsearchTemplate<span class="class">.<span class="keyword">class</span> &#125;)</span></span><br><span class="line"><span class="class">@<span class="title">AutoConfigureAfter</span>(</span>&#123; ElasticsearchAutoConfiguration<span class="class">.<span class="keyword">class</span>, <span class="title">RestClientAutoConfiguration</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">                     <span class="title">ReactiveRestClientAutoConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class">@<span class="title">Import</span>(</span>&#123; ElasticsearchDataConfiguration.BaseConfiguration<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">         <span class="title">ElasticsearchDataConfiguration</span>.<span class="title">TransportClientConfiguration</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">         <span class="title">ElasticsearchDataConfiguration</span>.<span class="title">RestClientConfiguration</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">         <span class="title">ElasticsearchDataConfiguration</span>.<span class="title">ReactiveRestClientConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ElasticsearchDataAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ“ä½œç±»</p>
<ul>
<li><p>Jest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Index index = <span class="keyword">new</span> Index.Builder(news).index(<span class="string">"love"</span>).type(<span class="string">"news"</span>).id(<span class="string">"1"</span>).build();</span><br><span class="line">jestClient.execute(index);</span><br><span class="line">Get get = <span class="keyword">new</span> Get.Builder(<span class="string">"love"</span>, <span class="string">"1"</span>).type(<span class="string">"news"</span>).build();</span><br><span class="line">DocumentResult documentResult = jestClient.execute(get);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Repository</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bookRepo.index(book);</span><br><span class="line">Optional&lt;Book&gt; optional = bookRepo.findById(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>ElasticsearchTemplate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IndexQuery query = <span class="keyword">new</span> IndexQuery();</span><br><span class="line">query.setIndexName(<span class="string">"yong"</span>);</span><br><span class="line">query.setType(<span class="string">"news"</span>);</span><br><span class="line">query.setObject(news);</span><br><span class="line">query.setId(<span class="string">"1"</span>);</span><br><span class="line">elasticsearchTemplate.index(query);</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="ä»»åŠ¡"><a href="#ä»»åŠ¡" class="headerlink" title="ä»»åŠ¡"></a>ä»»åŠ¡</h2><blockquote>
<p>spring boot æ”¯æŒå„ç§ä»»åŠ¡</p>
</blockquote>
<h3 id="å¼‚æ­¥ä»»åŠ¡"><a href="#å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡"></a>å¼‚æ­¥ä»»åŠ¡</h3><blockquote>
<p>é€šè¿‡æ³¨è§£å¼‚æ­¥ä»»åŠ¡æ”¯æŒ</p>
</blockquote>
<ul>
<li><p>@Async æ ‡æ³¨ä¸€ä¸ªæ–¹æ³•å°†å¼‚æ­¥æ‰§è¡Œ ï¼ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAsync</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    logger.info(<span class="string">"starting......."</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;		</span><br><span class="line">    logger.info(<span class="string">"done......."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@EnableAync å¼€å¯å¼‚æ­¥æ”¯æŒ éœ€è¦æ ‡åœ¨ä¸»é…ç½®ç±»ä¸Š</p>
</li>
</ul>
<h3 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h3><blockquote>
<p>é€šè¿‡æ³¨è§£é©±åŠ¨</p>
</blockquote>
<ul>
<li><p>@Scheduled æ ‡è®°ä¸€ä¸ªæ–¹æ³•ä¸ºå®šåˆ¶ä»»åŠ¡ è¯¥æ–¹æ³•ä¸å¯å¸¦å‚æ•°å’Œè¿”å›å€¼</p>
<ul>
<li><p>corn æ—¶é—´é—´éš”è¡¨è¾¾å¼</p>
<p>ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨</p>
<p>ç‰¹æ®Šå­—ç¬¦</p>
<ul>
<li><strong>,</strong> æšä¸¾</li>
<li>- åŒºé—´</li>
<li>* ä»»æ„</li>
<li>/ æ­¥é•¿ 0/4 ä»0ç§’å¯åŠ¨ æ¯4ç§’æ‰§è¡Œä¸€æ¬¡</li>
<li>? æ—¥ /æ˜ŸæœŸ  å†²çªåŒ¹é…</li>
<li>L æœ€å</li>
<li>W å·¥ä½œæ—¥</li>
<li>C äºcalendarè”ç³»åè®¡ç®—çš„å€¼</li>
<li># æ˜ŸæœŸ  4#2  ç¬¬äºŒä¸ªæ˜ŸæœŸå››</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scheduled</span>(cron=<span class="string">"* * * * * MON-FRI"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSchedule</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    logger.info(<span class="string">"do schedule....."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@EnableScheduling å¼€å¯å®šæ—¶ä»»åŠ¡åŠŸèƒ½</p>
</li>
</ul>
<h3 id="é‚®ä»¶ä»»åŠ¡"><a href="#é‚®ä»¶ä»»åŠ¡" class="headerlink" title="é‚®ä»¶ä»»åŠ¡"></a>é‚®ä»¶ä»»åŠ¡</h3><blockquote>
<p>springbootæä¾›äº†é‚®ä»¶ç›¸å…³starter</p>
</blockquote>
<ul>
<li><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é‚®ä»¶é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‚®ä»¶ç”¨æˆ·å</span></span><br><span class="line"><span class="meta">spring.mail.username</span>=<span class="string">2455499971@qq.com</span></span><br><span class="line"><span class="comment"># æˆæƒç </span></span><br><span class="line"><span class="meta">spring.mail.password</span>=<span class="string"></span></span><br><span class="line"><span class="comment"># é‚®ä»¶æœåŠ¡å™¨åœ°å€</span></span><br><span class="line"><span class="meta">spring.mail.host</span>=<span class="string">smtp.qq.com</span></span><br><span class="line"><span class="comment"># å¼€å¯ssl</span></span><br><span class="line"><span class="meta">spring.mail.properties.mail.smtp.ssl.enable</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># ç«¯å£</span></span><br><span class="line"><span class="meta">spring.mail.port</span>=<span class="string"></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å‘é€é‚®ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">JavaMailSenderImpl sender;</span><br><span class="line"><span class="comment">// å‘é€ç®€å•é‚®ä»¶</span></span><br><span class="line">SimpleMailMessage mail = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">mail.setTo(<span class="string">"asdfghjklhcy@hotmail.com"</span>);</span><br><span class="line">mail.setFrom(<span class="string">"2455499971@qq.com"</span>);</span><br><span class="line">mail.setSubject(<span class="string">"test"</span>);</span><br><span class="line">mail.setText(<span class="string">"è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶"</span>);</span><br><span class="line">sender.send(mail);</span><br><span class="line"><span class="comment">// å¸¦é™„ä»¶çš„é‚®ä»¶</span></span><br><span class="line">MimeMessage mimeMessage = sender.createMimeMessage();	</span><br><span class="line">MimeMessageHelper helper = <span class="keyword">new</span>  MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">helper.setTo(<span class="string">"asdfghjklhcy@hotmail.com"</span>);</span><br><span class="line">helper.setFrom(<span class="string">"2455499971@qq.com"</span>);</span><br><span class="line">helper.setText(<span class="string">"&lt;h1 style='color:red'&gt;å¤§æ–°é—»&lt;/h1&gt;"</span>, <span class="keyword">true</span>);</span><br><span class="line">helper.setSubject(<span class="string">"breaking news"</span>);</span><br><span class="line">helper.addAttachment(<span class="string">"test.jpg"</span>, <span class="keyword">new</span> File(<span class="string">""</span>));</span><br><span class="line">sender.send(mimeMessage);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><blockquote>
<p>springboot æ•´åˆäº† spring security é€šè¿‡starterå‘ˆç°</p>
</blockquote>
<h3 id="spring-security"><a href="#spring-security" class="headerlink" title="spring security"></a>spring security</h3><blockquote>
<p>å®‰å…¨æ¡†æ¶ æ•´åˆäº†æƒé™éªŒè¯ç­‰ç­‰å®‰å…¨æ‰‹æ®µ</p>
</blockquote>
<ul>
<li><p>ä¾èµ–å¯¼å…¥</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>demo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰spring security é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * å®šä¹‰æˆæƒè§„åˆ™</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="comment">// url æƒé™éªŒè¯ è§„åˆ™</span></span><br><span class="line">        http.authorizeRequests().antMatchers(<span class="string">"/level1/**"</span>).hasRole(<span class="string">"l1"</span>);</span><br><span class="line">        http.formLogin().loginProcessingUrl(<span class="string">"/auth"</span>).successForwardUrl(<span class="string">"/level1"</span>);</span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰ç™»é™†é¡µé¢</span></span><br><span class="line">        <span class="comment">//		http.formLogin().loginPage("");</span></span><br><span class="line">        <span class="comment">// æ³¨é”€url  é»˜è®¤ /logout</span></span><br><span class="line">        http.logout();</span><br><span class="line">        <span class="comment">// è®°ä½æˆ‘ (å¯ç”¨å cookieåœ¨æ³¨é”€åä¼šé”€æ¯)</span></span><br><span class="line">        http.rememberMe();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è®¤è¯è§„åˆ™</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * è‡ªå®šä¹‰ç”¨æˆ·è§’è‰²</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</span><br><span class="line">        UserDetails user = User.withDefaultPasswordEncoder()</span><br><span class="line">            .username(<span class="string">"root"</span>)</span><br><span class="line">            .password(<span class="string">"admin123"</span>)</span><br><span class="line">            .roles(<span class="string">"l1"</span>)</span><br><span class="line">            .build();</span><br><span class="line">        <span class="comment">// å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line">        auth.inMemoryAuthentication().withUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h2 id="åˆ†å¸ƒå¼"><a href="#åˆ†å¸ƒå¼" class="headerlink" title="åˆ†å¸ƒå¼"></a>åˆ†å¸ƒå¼</h2><blockquote>
<p>æ ¹æ®å¾®æœåŠ¡æ€æƒ³ å°†ä¸€ä¸ªå¤§å‹åº”ç”¨æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°æ¨¡å— å°†é€šè¿‡åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ç»„æˆåˆ†å¸ƒå¼ç³»ç»Ÿ</p>
<p>å¸¸è§çš„æ¡†æ¶åŒ…æ‹¬</p>
<ol>
<li><p>ZooKeeper</p>
<p>æ³¨å†Œä¸­å¿ƒ åè°ƒå¾®æœåŠ¡</p>
</li>
<li><p>Dubbo</p>
<p>è°ƒç”¨æ¡†æ¶     è´Ÿè´£è°ƒç”¨å¾®æœåŠ¡</p>
</li>
</ol>
</blockquote>
<h3 id="ZooKeeper-Dubbo"><a href="#ZooKeeper-Dubbo" class="headerlink" title="ZooKeeper+Dubbo"></a>ZooKeeper+Dubbo</h3><blockquote>
<p>è§£å†³ä¸¤ä¸ªæœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨é—®é¢˜</p>
<p>é€šè¿‡æ¥å£å…±äº«å®ç°è¿œç¨‹è°ƒç”¨</p>
</blockquote>
<ol>
<li><p>åˆ›å»ºä¸¤ä¸ªå­é¡¹ç›®åˆ†ä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… å’Œä¸€ä¸ªå…¬å…±api</p>
</li>
<li><p>ä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”Ÿäº§è€…å®ç°å…¬å…±api</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">// å°†æœåŠ¡æ³¨å†Œåˆ°zookeeperå®¹å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProviderServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProviderService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">doProvide</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"getting product"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¶ˆè´¹è€…ä»å®¹å™¨ä¸­è·å–æ¥å£å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Reference</span>  <span class="comment">// ä»å®¹å™¨ä¸­è·å–</span></span><br><span class="line">    ProviderService providerService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCustome</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(providerService.getClass());</span><br><span class="line">        String s = providerService.doProvide();</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>dubboé…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">dubbo.application.name</span>=<span class="string">provider</span></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://localhost:2181</span></span><br><span class="line"><span class="meta">dubbo.scan.base-packages</span>=<span class="string">com.yong.springboot.service</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h3><blockquote>
<p>springæä¾›çš„åˆ†å¸ƒå¼æ•´ä½“è§£å†³æ–¹æ¡ˆ</p>
</blockquote>
<ul>
<li><p>äº”å¤§ç»„ä»¶</p>
<ul>
<li>Netflix Eureka æœåŠ¡å‘ç°</li>
<li>Netflix Ribbon å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</li>
<li>Netflix Hystrix æ–­è·¯å™¨</li>
<li>Netflix Zuul æœåŠ¡ç½‘å…³</li>
<li>Spring Cloud Config åˆ†å¸ƒå¼é…ç½®</li>
</ul>
</li>
<li><p>Eureka</p>
<p>åŸºäºhttpåè®®çš„è¿œç¨‹è°ƒç”¨</p>
<p>æ³¨å†Œä¸­å¿ƒ(æœåŠ¡å™¨)é…ç½®</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">euraka-server</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span> <span class="comment"># æ³¨å†Œä¸­å¿ƒæœ¬èº«ä¸æ³¨å†Œ</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span> <span class="comment"># ä¸è·å–æ³¨å†Œä¿¡æ¯</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8000/eureka/</span> <span class="comment"># æœåŠ¡æ³¨å†Œåœ°å€</span></span><br></pre></td></tr></table></figure>

<p>ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment"># æ³¨å†ŒæœåŠ¡æ—¶ ä½¿ç”¨æœåŠ¡çš„IPåœ°å€</span></span><br><span class="line">    <span class="attr">appname:</span> <span class="string">producer</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8000/eureka/</span></span><br></pre></td></tr></table></figure>

<p>æ¿€æ´»eurekaæœåŠ¡å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaServerApplication</span></span></span><br></pre></td></tr></table></figure>

<p>å¯ç”¨æœåŠ¡å‘ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaConsumerApplication</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>è¿œç¨‹è°ƒç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/consume"</span>)</span><br><span class="line"><span class="function">String <span class="title">consume</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://PRODUCER/produce"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="çƒ­éƒ¨ç½²"><a href="#çƒ­éƒ¨ç½²" class="headerlink" title="çƒ­éƒ¨ç½²"></a>çƒ­éƒ¨ç½²</h2><blockquote>
<p>é€šè¿‡å¼•å…¥springbootæä¾›çš„devtoolå®ç°çƒ­é‡è½½</p>
<p>å¯¹äºIDEA ä¿®æ”¹åæŒ‰Ctrl+f9 é‡è½½</p>
<p>å¯¹Eclipse Ctrl + sä¿å­˜åé‡è½½</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="çŠ¶æ€ç›‘æ§"><a href="#çŠ¶æ€ç›‘æ§" class="headerlink" title="çŠ¶æ€ç›‘æ§"></a>çŠ¶æ€ç›‘æ§</h2><blockquote>
<p>springbootæä¾›äº†actuatçŠ¶æ€ç›‘æ§ç»„ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>é…ç½®ä¿¡æ¯</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># autoconfig æ‰€æœ‰è‡ªåŠ¨é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># auditevents å®¡è®¡äº‹ä»¶</span></span><br><span class="line"><span class="comment"># beans æ‰€æœ‰beanä¿¡æ¯</span></span><br><span class="line"><span class="comment"># configprops æ‰€æœ‰é…ç½®å±æ€§</span></span><br><span class="line"><span class="comment"># threaddump çº¿ç¨‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># env å½“å‰ç¯å¢ƒä¿¡æ¯</span></span><br><span class="line"><span class="comment"># health åº”ç”¨å¥åº·çŠ¶å†µ</span></span><br><span class="line"><span class="comment"># info åº”ç”¨ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># metrics åº”ç”¨çš„å„é¡¹æŒ‡æ ‡</span></span><br><span class="line"><span class="comment"># mappings åº”ç”¨@RequestMappingæ˜ å°„è·¯å¾„</span></span><br><span class="line"><span class="comment"># shutdown å…³é—­å½“å‰åº”ç”¨</span></span><br><span class="line"><span class="comment"># trace è¿½è¸ªä¿¡æ¯</span></span><br><span class="line"><span class="comment"># heapdump å †è½¬å‚¨æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># æš´éœ²ç«¯ç‚¹</span></span><br><span class="line"><span class="meta">management.endpoints.web.exposure.include</span>=<span class="string">health,info,beans,env</span></span><br><span class="line"><span class="comment"># å¯ç”¨æŸä¸ªç«¯ç‚¹</span></span><br><span class="line"><span class="meta">management.endpoint.shutdown.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># å…¥å£url</span></span><br><span class="line"><span class="meta">management.endpoints.web.base-path</span>=<span class="string"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šç«¯å£</span></span><br><span class="line"><span class="meta">management.server.port</span>=<span class="string">8081</span></span><br><span class="line"><span class="comment"># æ€»æ˜¯æ˜¾ç¤ºå¥åº·çŠ¶æ€ç»†èŠ‚</span></span><br><span class="line"><span class="meta">management.endpoint.health.show-details</span>=<span class="string">always</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="è‡ªå®šä¹‰HealthIndicator"><a href="#è‡ªå®šä¹‰HealthIndicator" class="headerlink" title="è‡ªå®šä¹‰HealthIndicator"></a>è‡ªå®šä¹‰HealthIndicator</h4><blockquote>
<p>é€šè¿‡å®ç°HealthIndicator å¯è‡ªå®šä¹‰å¥åº·çŠ¶æ€ä¿¡æ¯  å‘½åå¿…é¡»ç¬¦åˆ <strong>xxxHealthIndicator</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppHealthIndicator</span> <span class="keyword">implements</span> <span class="title">HealthIndicator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Health <span class="title">health</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Health.down().withDetail(<span class="string">"error"</span>, <span class="string">"internal error"</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>






    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/spring/" rel="tag"># spring</a>
              <a href="/tags/springboot/" rel="tag"># springboot</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/11/helloworld/" rel="prev" title="helloworld">
      <i class="fa fa-chevron-left"></i> helloworld
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/12/JAVA%E7%AE%97%E6%B3%95%E7%A7%98%E7%B1%8D/" rel="next" title="JAVAæ•°æ®ç»“æ„ä¸ç®—æ³•">
      JAVAæ•°æ®ç»“æ„ä¸ç®—æ³• <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringBootå…¥é—¨æŒ‡å—"><span class="nav-number">1.</span> <span class="nav-text">SpringBootå…¥é—¨æŒ‡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#å¿«é€Ÿå…¥é—¨"><span class="nav-number">1.1.</span> <span class="nav-text">å¿«é€Ÿå…¥é—¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ„å»º"><span class="nav-number">1.1.1.</span> <span class="nav-text">æ„å»º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç›®å½•ä¸€è§ˆ"><span class="nav-number">1.1.2.</span> <span class="nav-text">ç›®å½•ä¸€è§ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯åŠ¨ç±»"><span class="nav-number">1.1.3.</span> <span class="nav-text">å¯åŠ¨ç±»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é¡¹ç›®æ‰“åŒ…"><span class="nav-number">1.1.4.</span> <span class="nav-text">é¡¹ç›®æ‰“åŒ…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é¡¹ç›®ä¾èµ–"><span class="nav-number">1.1.5.</span> <span class="nav-text">é¡¹ç›®ä¾èµ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯åŠ¨æµç¨‹"><span class="nav-number">1.1.6.</span> <span class="nav-text">å¯åŠ¨æµç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#äº‹ä»¶ç›‘å¬"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">äº‹ä»¶ç›‘å¬</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åŸºæœ¬é…ç½®"><span class="nav-number">1.2.</span> <span class="nav-text">åŸºæœ¬é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è‡ªåŠ¨é…ç½®"><span class="nav-number">1.2.1.</span> <span class="nav-text">è‡ªåŠ¨é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å¯ç”¨è‡ªåŠ¨é…ç½®"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">å¯ç”¨è‡ªåŠ¨é…ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è‡ªåŠ¨é…ç½®ç±»"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">è‡ªåŠ¨é…ç½®ç±»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¡ä»¶é…ç½®"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">æ¡ä»¶é…ç½®</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ‰‹åŠ¨é…ç½®"><span class="nav-number">1.2.2.</span> <span class="nav-text">æ‰‹åŠ¨é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®ç»‘å®š"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">é…ç½®ç»‘å®š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£é…ç½®"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">æ³¨è§£é…ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šç¯å¢ƒé…ç½®"><span class="nav-number">1.2.3.</span> <span class="nav-text">å¤šç¯å¢ƒé…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å¤šProfileé…ç½®æ–‡ä»¶"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">å¤šProfileé…ç½®æ–‡ä»¶</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ—¥å¿—"><span class="nav-number">1.3.</span> <span class="nav-text">æ—¥å¿—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ—¥å¿—æ¡†æ¶ç»Ÿä¸€"><span class="nav-number">1.3.1.</span> <span class="nav-text">æ—¥å¿—æ¡†æ¶ç»Ÿä¸€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ—¥å¿—é…ç½®"><span class="nav-number">1.3.2.</span> <span class="nav-text">æ—¥å¿—é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è‡ªå®šä¹‰é…ç½®"><span class="nav-number">1.3.3.</span> <span class="nav-text">è‡ªå®šä¹‰é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ‡æ¢æ—¥å¿—æ¡†æ¶"><span class="nav-number">1.3.4.</span> <span class="nav-text">åˆ‡æ¢æ—¥å¿—æ¡†æ¶</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB"><span class="nav-number">1.4.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é™æ€èµ„æº"><span class="nav-number">1.4.1.</span> <span class="nav-text">é™æ€èµ„æº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thymeleaf"><span class="nav-number">1.4.2.</span> <span class="nav-text">Thymeleaf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#webmvc"><span class="nav-number">1.4.3.</span> <span class="nav-text">webmvc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è‡ªåŠ¨é…ç½®-1"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">è‡ªåŠ¨é…ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é™„åŠ é…ç½®"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">é™„åŠ é…ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é”™è¯¯å¤„ç†"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">é”™è¯¯å¤„ç†</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®šåˆ¶åŒ–WEBå®¹å™¨"><span class="nav-number">1.5.</span> <span class="nav-text">å®šåˆ¶åŒ–WEBå®¹å™¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®¹å™¨é…ç½®"><span class="nav-number">1.5.1.</span> <span class="nav-text">å®¹å™¨é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ³¨å†Œä¸‰å¤§ç»„ä»¶"><span class="nav-number">1.5.2.</span> <span class="nav-text">æ³¨å†Œä¸‰å¤§ç»„ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ‡æ¢webå®¹å™¨"><span class="nav-number">1.5.3.</span> <span class="nav-text">åˆ‡æ¢webå®¹å™¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨å¤–éƒ¨å®¹å™¨"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">ä½¿ç”¨å¤–éƒ¨å®¹å™¨</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®è®¿é—®"><span class="nav-number">1.6.</span> <span class="nav-text">æ•°æ®è®¿é—®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JDBC"><span class="nav-number">1.6.1.</span> <span class="nav-text">JDBC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•°æ®æºç›‘æ§"><span class="nav-number">1.6.2.</span> <span class="nav-text">æ•°æ®æºç›‘æ§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•´åˆMyBatis"><span class="nav-number">1.6.3.</span> <span class="nav-text">æ•´åˆMyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Mapper-é…ç½®"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">Mapper é…ç½®</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JPA"><span class="nav-number">1.6.4.</span> <span class="nav-text">JPA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å…¥é—¨"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">å…¥é—¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨è§£å…³ç³»æ˜ å°„"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">æ³¨è§£å…³ç³»æ˜ å°„</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Repository"><span class="nav-number">1.6.4.3.</span> <span class="nav-text">Repository</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è‡ªå®šä¹‰starter"><span class="nav-number">1.7.</span> <span class="nav-text">è‡ªå®šä¹‰starter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¼“å­˜"><span class="nav-number">1.8.</span> <span class="nav-text">ç¼“å­˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#starter"><span class="nav-number">1.8.1.</span> <span class="nav-text">starter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ³¨è§£é©±åŠ¨ç¼“å­˜"><span class="nav-number">1.8.2.</span> <span class="nav-text">æ³¨è§£é©±åŠ¨ç¼“å­˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•´åˆRedis"><span class="nav-number">1.8.3.</span> <span class="nav-text">æ•´åˆRedis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¶ˆæ¯ä¸­é—´ä»¶"><span class="nav-number">1.9.</span> <span class="nav-text">æ¶ˆæ¯ä¸­é—´ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¦‚è¿°"><span class="nav-number">1.9.1.</span> <span class="nav-text">æ¦‚è¿°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RabbitMQ"><span class="nav-number">1.9.2.</span> <span class="nav-text">RabbitMQ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#springbootæ•´åˆ"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">springbootæ•´åˆ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å…¨æ–‡æ£€ç´¢"><span class="nav-number">1.10.</span> <span class="nav-text">å…¨æ–‡æ£€ç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ElasticSerach"><span class="nav-number">1.10.1.</span> <span class="nav-text">ElasticSerach</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#springbootæ•´åˆ-1"><span class="nav-number">1.10.1.1.</span> <span class="nav-text">springbootæ•´åˆ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»»åŠ¡"><span class="nav-number">1.11.</span> <span class="nav-text">ä»»åŠ¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¼‚æ­¥ä»»åŠ¡"><span class="nav-number">1.11.1.</span> <span class="nav-text">å¼‚æ­¥ä»»åŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®šæ—¶ä»»åŠ¡"><span class="nav-number">1.11.2.</span> <span class="nav-text">å®šæ—¶ä»»åŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é‚®ä»¶ä»»åŠ¡"><span class="nav-number">1.11.3.</span> <span class="nav-text">é‚®ä»¶ä»»åŠ¡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®‰å…¨"><span class="nav-number">1.12.</span> <span class="nav-text">å®‰å…¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#spring-security"><span class="nav-number">1.12.1.</span> <span class="nav-text">spring security</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ†å¸ƒå¼"><span class="nav-number">1.13.</span> <span class="nav-text">åˆ†å¸ƒå¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ZooKeeper-Dubbo"><span class="nav-number">1.13.1.</span> <span class="nav-text">ZooKeeper+Dubbo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Cloud"><span class="nav-number">1.13.2.</span> <span class="nav-text">Spring Cloud</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#çƒ­éƒ¨ç½²"><span class="nav-number">1.14.</span> <span class="nav-text">çƒ­éƒ¨ç½²</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#çŠ¶æ€ç›‘æ§"><span class="nav-number">1.15.</span> <span class="nav-text">çŠ¶æ€ç›‘æ§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è‡ªå®šä¹‰HealthIndicator"><span class="nav-number">1.15.0.1.</span> <span class="nav-text">è‡ªå®šä¹‰HealthIndicator</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yong"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">yong</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Herface" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Herface" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">He</span>
</div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>


        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  













<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

</body>
</html>
